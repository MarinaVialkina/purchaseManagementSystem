{"version":3,"file":"DatePickerTypeDate.js","names":["addMonths","startOfMonth","React","forwardRef","useEffect","useRef","useClickOutside","useForkRef","setRef","DatePickerDropdown","DatePickerFieldTypeDate","getDropdownZIndex","datePickerPropDateTimeViewDefault","useCalendarVisible","useCurrentVisibleDate","DatePickerTypeDate","props","ref","events","dateTimeView","locale","dropdownClassName","dropdownRef","dropdownForm","currentVisibleDateProp","currentVisibleDate","onChangeCurrentVisibleDate","renderAdditionalControls","onDropdownOpen","dropdownOpen","ignoreOutsideClicksRefs","disabled","disableDates","inputRefProp","inputRef","dropdownViewportRef","otherProps","fieldRef","calendarRef","startRef","calendarVisible","setCalendarVisible","maxDate","minDate","value","startOfUnit","setCurrentVisibleDate","current","newVisibleDate","getTime","isActive","ignoreClicksInsideRefs","handler","off","on","args","onChange","style"],"sources":["../../../../../../src/components/DatePicker/DatePickerTypeDate/DatePickerTypeDate.tsx"],"sourcesContent":["import addMonths from 'date-fns/addMonths';\nimport startOfMonth from 'date-fns/startOfMonth';\nimport React, { forwardRef, useEffect, useRef } from 'react';\n\nimport { useClickOutside } from '##/hooks/useClickOutside';\nimport { useForkRef } from '##/hooks/useForkRef';\nimport { setRef } from '##/utils/setRef';\n\nimport { DatePickerDropdown } from '../DatePickerDropdown/DatePickerDropdown';\nimport { DatePickerFieldTypeDate } from '../DatePickerFieldTypeDate/DatePickerFieldTypeDate';\nimport { getDropdownZIndex } from '../helpers';\nimport {\n  datePickerPropDateTimeViewDefault,\n  DatePickerTypeComponent,\n} from '../types';\nimport { useCalendarVisible } from '../useCalendarVisible';\nimport { useCurrentVisibleDate } from '../useCurrentVisibleDate';\n\nexport const DatePickerTypeDate: DatePickerTypeComponent<'date'> = forwardRef(\n  (props, ref) => {\n    const {\n      events,\n      dateTimeView = datePickerPropDateTimeViewDefault,\n      locale,\n      dropdownClassName,\n      dropdownRef,\n      dropdownForm,\n      currentVisibleDate: currentVisibleDateProp,\n      onChangeCurrentVisibleDate,\n      renderAdditionalControls,\n      onDropdownOpen,\n      dropdownOpen,\n      ignoreOutsideClicksRefs,\n      disabled,\n      disableDates,\n      inputRef: inputRefProp,\n      dropdownViewportRef,\n      ...otherProps\n    } = props;\n\n    const fieldRef = useRef<HTMLDivElement>(null);\n    const calendarRef = useRef<HTMLDivElement>(null);\n    const inputRef = useRef<HTMLInputElement>(null);\n\n    const [calendarVisible, setCalendarVisible] = useCalendarVisible({\n      dropdownOpen,\n      onDropdownOpen,\n      disabled,\n      startRef: inputRef,\n    });\n\n    const [currentVisibleDate, setCurrentVisibleDate] = useCurrentVisibleDate({\n      currentVisibleDate: currentVisibleDateProp,\n      maxDate: props.maxDate,\n      minDate: props.minDate,\n      value: props.value,\n      startOfUnit: startOfMonth,\n      onChangeCurrentVisibleDate,\n      calendarVisible,\n    });\n\n    useEffect(() => {\n      if (ref) {\n        setRef(ref, fieldRef.current);\n      }\n    }, [ref, fieldRef]);\n\n    useEffect(() => {\n      if (props.value && dateTimeView === 'classic' && currentVisibleDate) {\n        const newVisibleDate = startOfMonth(props.value);\n        if (newVisibleDate.getTime() !== currentVisibleDate.getTime()) {\n          setCurrentVisibleDate(newVisibleDate);\n        }\n        return;\n      }\n      if (props.value && dateTimeView !== 'classic' && currentVisibleDate) {\n        const newVisibleDate = startOfMonth(props.value);\n        if (\n          newVisibleDate.getTime() !== currentVisibleDate.getTime() &&\n          newVisibleDate.getTime() !==\n            addMonths(currentVisibleDate, 1).getTime()\n        ) {\n          setCurrentVisibleDate(newVisibleDate);\n        }\n      }\n    }, [props.value]);\n\n    useClickOutside({\n      isActive: calendarVisible,\n      ignoreClicksInsideRefs: [\n        fieldRef,\n        calendarRef,\n        ...(ignoreOutsideClicksRefs ?? []),\n      ],\n      handler: setCalendarVisible.off,\n    });\n\n    return (\n      <>\n        <DatePickerFieldTypeDate\n          {...otherProps}\n          disabled={disabled}\n          ref={fieldRef}\n          inputRef={useForkRef([inputRef, inputRefProp])}\n          onClick={setCalendarVisible.on}\n        />\n        <DatePickerDropdown\n          ref={useForkRef([dropdownRef, calendarRef])}\n          viewportRef={dropdownViewportRef}\n          anchorRef={fieldRef}\n          isOpen={calendarVisible}\n          value={props.value || undefined}\n          type=\"date\"\n          view={dateTimeView}\n          events={events}\n          locale={locale}\n          minDate={props.minDate}\n          className={dropdownClassName}\n          maxDate={props.maxDate}\n          currentVisibleDate={currentVisibleDate}\n          form={dropdownForm}\n          onChange={(...args) => {\n            props.onChange?.(...args);\n            setCalendarVisible.off();\n          }}\n          renderAdditionalControls={renderAdditionalControls}\n          disableDates={disableDates}\n          zIndex={getDropdownZIndex(props.style)}\n          onChangeCurrentVisibleDate={setCurrentVisibleDate}\n        />\n      </>\n    );\n  },\n);\n"],"mappings":"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"}