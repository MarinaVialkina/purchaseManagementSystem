{"version":3,"file":"DatePickerDropdown.js","names":["React","forwardRef","useCallback","useRef","useState","Transition","DateTime","Popover","useFlag","useForkRef","animateTimeout","cnMixPopoverAnimate","cn","DatePickerAdditionalControls","datePickerPropDropdownFormDefault","moveMap","cnDatePickerDropdown","DatePickerDropdown","props","componentRef","form","anchorRef","isOpen","className","zIndex","renderAdditionalControls","viewportRef","otherProps","rootRef","direction","setDirection","visibleAdditionalControls","setVisibleAdditionalControls","onMove","to","type","on","off","ref","animate","currentVisibleDate","view"],"sources":["../../../../../../src/components/DatePicker/DatePickerDropdown/DatePickerDropdown.tsx"],"sourcesContent":["import './DatePickerDropdown.css';\n\nimport React, { forwardRef, useCallback, useRef, useState } from 'react';\nimport { Transition } from 'react-transition-group';\n\nimport {\n  DateTime,\n  DateTimePropOnChange,\n  DateTimePropType,\n  MoveType,\n} from '##/components/DateTime';\nimport {\n  DateTimePropDisableDates,\n  TimeOptions,\n} from '##/components/DateTime/helpers/types';\nimport { Direction, Popover } from '##/components/Popover';\nimport { useFlag } from '##/hooks/useFlag';\nimport { useForkRef } from '##/hooks/useForkRef';\nimport { animateTimeout, cnMixPopoverAnimate } from '##/mixs/MixPopoverAnimate';\nimport { cn } from '##/utils/bem';\nimport { DateRange } from '##/utils/types/Date';\nimport { PropsWithHTMLAttributesAndRef } from '##/utils/types/PropsWithHTMLAttributes';\n\nimport { DatePickerAdditionalControls } from '../DatePickerAdditionalControls/DatePickerAdditionalControls';\nimport {\n  DatePickerAdditionalControlRenderProp,\n  DatePickerPropDateTimeView,\n  DatePickerPropDropdownForm,\n  datePickerPropDropdownFormDefault,\n} from '../types';\n\nexport type DatePickerDropdownPropOnChange = DateTimePropOnChange;\n\nexport type DatePickerDropdownProps = PropsWithHTMLAttributesAndRef<\n  {\n    anchorRef: React.RefObject<HTMLElement>;\n    currentVisibleDate?: Date;\n    type: DateTimePropType;\n    value?: Date | DateRange;\n    onChange?: DatePickerDropdownPropOnChange;\n    minDate?: Date;\n    maxDate?: Date;\n    events?: Date[];\n    view: DatePickerPropDateTimeView;\n    locale?: Locale;\n    children?: never;\n    form?: DatePickerPropDropdownForm;\n    isOpen?: boolean;\n    onChangeCurrentVisibleDate?: (date: Date) => void;\n    zIndex?: number;\n    renderAdditionalControls?: DatePickerAdditionalControlRenderProp;\n    timeOptions?: TimeOptions;\n    timeFor?: 'start' | 'end';\n    disableDates?: DateTimePropDisableDates;\n    viewportRef?: React.RefObject<HTMLElement>;\n  },\n  HTMLDivElement\n>;\n\ntype DatePickerDropdownComponent = (\n  props: DatePickerDropdownProps,\n) => React.ReactNode | null;\n\nconst moveMap: Record<DateTimePropType, MoveType> = {\n  'year': 'year',\n  'month': 'month',\n  'date': 'day',\n  'time': 'time',\n  'date-time': 'day',\n};\n\nconst cnDatePickerDropdown = cn('DatePickerDropdown');\n\nexport const DatePickerDropdown: DatePickerDropdownComponent = forwardRef(\n  (props, componentRef) => {\n    const {\n      form = datePickerPropDropdownFormDefault,\n      anchorRef,\n      isOpen,\n      className,\n      zIndex,\n      renderAdditionalControls,\n      viewportRef,\n      ...otherProps\n    } = props;\n\n    const rootRef = useRef<HTMLDivElement>(null);\n    const [direction, setDirection] = useState<Direction>();\n\n    const [visibleAdditionalControls, setVisibleAdditionalControls] =\n      useFlag(true);\n\n    const onMove = useCallback(\n      (to: MoveType) => {\n        to === moveMap[props.type]\n          ? setVisibleAdditionalControls.on()\n          : setVisibleAdditionalControls.off();\n      },\n      [props.type],\n    );\n\n    const ref = useForkRef([componentRef, rootRef]);\n\n    return (\n      <Transition\n        in={isOpen}\n        unmountOnExit\n        timeout={animateTimeout}\n        nodeRef={rootRef}\n      >\n        {(animate) => {\n          return (\n            <Popover\n              ref={ref}\n              anchorRef={anchorRef}\n              className={cnDatePickerDropdown({ form }, [\n                className,\n                cnMixPopoverAnimate({ direction, animate }),\n              ])}\n              direction=\"downStartLeft\"\n              spareDirection=\"downStartLeft\"\n              possibleDirections={[\n                'downStartLeft',\n                'upStartLeft',\n                'downStartRight',\n                'upStartRight',\n              ]}\n              style={{ zIndex }}\n              role=\"listbox\"\n              onSetDirection={setDirection}\n              viewportRef={viewportRef}\n            >\n              <DateTime {...otherProps} onMove={onMove} />\n              {visibleAdditionalControls && (\n                <DatePickerAdditionalControls\n                  currentVisibleDate={props.currentVisibleDate}\n                  renderAdditionalControls={renderAdditionalControls}\n                  type={props.type}\n                  view={props.view}\n                />\n              )}\n            </Popover>\n          );\n        }}\n      </Transition>\n    );\n  },\n);\n"],"mappings":"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"}