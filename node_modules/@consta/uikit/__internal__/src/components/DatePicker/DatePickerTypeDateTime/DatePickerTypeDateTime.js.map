{"version":3,"file":"DatePickerTypeDateTime.js","names":["addMonths","startOfMonth","React","forwardRef","useEffect","useRef","useClickOutside","useForkRef","setRef","DatePickerDropdown","DatePickerFieldTypeDateTime","datePickerPropFormatTypeDateTime","getDropdownZIndex","getTimeOptionsByFormat","useCalendarVisible","useCurrentVisibleDate","DatePickerTypeDateTime","props","ref","events","dateTimeView","locale","dropdownForm","dropdownClassName","dropdownRef","currentVisibleDateProp","currentVisibleDate","onChangeCurrentVisibleDate","timeOptionsProp","timeOptions","renderAdditionalControls","onDropdownOpen","dropdownOpen","ignoreOutsideClicksRefs","disabled","inputRefProp","inputRef","disableDates","dropdownViewportRef","otherProps","format","fieldRef","calendarRef","startRef","calendarVisible","setCalendarVisible","maxDate","minDate","value","startOfUnit","setCurrentVisibleDate","current","newVisibleDate","getTime","isActive","ignoreClicksInsideRefs","handler","off","on","onChange","style"],"sources":["../../../../../../src/components/DatePicker/DatePickerTypeDateTime/DatePickerTypeDateTime.tsx"],"sourcesContent":["import addMonths from 'date-fns/addMonths';\nimport startOfMonth from 'date-fns/startOfMonth';\nimport React, { forwardRef, useEffect, useRef } from 'react';\n\nimport { useClickOutside } from '##/hooks/useClickOutside/useClickOutside';\nimport { useForkRef } from '##/hooks/useForkRef';\nimport { setRef } from '##/utils/setRef';\n\nimport { DatePickerDropdown } from '../DatePickerDropdown/DatePickerDropdown';\nimport { DatePickerFieldTypeDateTime } from '../DatePickerFieldTypeDateTime/DatePickerFieldTypeDateTime';\nimport {\n  datePickerPropFormatTypeDateTime,\n  getDropdownZIndex,\n  getTimeOptionsByFormat,\n} from '../helpers';\nimport { DatePickerTypeComponent } from '../types';\nimport { useCalendarVisible } from '../useCalendarVisible';\nimport { useCurrentVisibleDate } from '../useCurrentVisibleDate';\n\nexport const DatePickerTypeDateTime: DatePickerTypeComponent<'date-time'> =\n  forwardRef((props, ref) => {\n    const {\n      events,\n      dateTimeView,\n      locale,\n      dropdownForm,\n      dropdownClassName,\n      dropdownRef,\n      currentVisibleDate: currentVisibleDateProp,\n      onChangeCurrentVisibleDate,\n      timeOptions: timeOptionsProp,\n      renderAdditionalControls,\n      onDropdownOpen,\n      dropdownOpen,\n      ignoreOutsideClicksRefs,\n      disabled,\n      inputRef: inputRefProp,\n      disableDates,\n      dropdownViewportRef,\n      ...otherProps\n    } = props;\n\n    const timeOptions = getTimeOptionsByFormat(\n      otherProps.format || datePickerPropFormatTypeDateTime,\n      timeOptionsProp,\n    );\n\n    const fieldRef = useRef<HTMLDivElement>(null);\n    const calendarRef = useRef<HTMLDivElement>(null);\n    const inputRef = useRef<HTMLInputElement>(null);\n\n    const [calendarVisible, setCalendarVisible] = useCalendarVisible({\n      dropdownOpen,\n      onDropdownOpen,\n      disabled,\n      startRef: inputRef,\n    });\n\n    const [currentVisibleDate, setCurrentVisibleDate] = useCurrentVisibleDate({\n      currentVisibleDate: currentVisibleDateProp,\n      maxDate: props.maxDate,\n      minDate: props.minDate,\n      value: props.value,\n      startOfUnit: startOfMonth,\n      onChangeCurrentVisibleDate,\n      calendarVisible,\n    });\n\n    useEffect(() => {\n      if (ref) {\n        setRef(ref, fieldRef.current);\n      }\n    }, [ref, fieldRef]);\n\n    useEffect(() => {\n      if (props.value && dateTimeView === 'classic' && currentVisibleDate) {\n        const newVisibleDate = startOfMonth(props.value);\n        if (newVisibleDate.getTime() !== currentVisibleDate.getTime()) {\n          setCurrentVisibleDate(newVisibleDate);\n        }\n        return;\n      }\n      if (props.value && dateTimeView !== 'classic' && currentVisibleDate) {\n        const newVisibleDate = startOfMonth(props.value);\n        if (\n          newVisibleDate.getTime() !== currentVisibleDate.getTime() &&\n          newVisibleDate.getTime() !==\n            addMonths(currentVisibleDate, 1).getTime()\n        ) {\n          setCurrentVisibleDate(newVisibleDate);\n        }\n      }\n    }, [props.value]);\n\n    useClickOutside({\n      isActive: calendarVisible,\n      ignoreClicksInsideRefs: [\n        fieldRef,\n        calendarRef,\n        ...(ignoreOutsideClicksRefs ?? []),\n      ],\n      handler: setCalendarVisible.off,\n    });\n\n    return (\n      <>\n        <DatePickerFieldTypeDateTime\n          {...otherProps}\n          ref={fieldRef}\n          inputRef={useForkRef([inputRef, inputRefProp])}\n          onClick={setCalendarVisible.on}\n          timeOptions={timeOptions}\n          disabled={disabled}\n        />\n        <DatePickerDropdown\n          ref={useForkRef([dropdownRef, calendarRef])}\n          viewportRef={dropdownViewportRef}\n          anchorRef={fieldRef}\n          isOpen={calendarVisible}\n          value={props.value || undefined}\n          type=\"date-time\"\n          view=\"classic\"\n          events={events}\n          className={dropdownClassName}\n          locale={locale}\n          minDate={props.minDate}\n          maxDate={props.maxDate}\n          currentVisibleDate={currentVisibleDate}\n          form={dropdownForm}\n          onChange={props.onChange}\n          renderAdditionalControls={renderAdditionalControls}\n          onChangeCurrentVisibleDate={setCurrentVisibleDate}\n          timeOptions={timeOptions}\n          zIndex={getDropdownZIndex(props.style)}\n          disableDates={disableDates}\n        />\n      </>\n    );\n  });\n"],"mappings":"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"}