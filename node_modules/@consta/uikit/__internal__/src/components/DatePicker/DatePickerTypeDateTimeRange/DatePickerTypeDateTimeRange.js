import _toConsumableArray from"@babel/runtime/helpers/toConsumableArray";import _slicedToArray from"@babel/runtime/helpers/slicedToArray";import _objectWithoutProperties from"@babel/runtime/helpers/objectWithoutProperties";var _excluded=["events","dateTimeView","locale","dropdownForm","onFocus","onBlur","leftSide","rightSide","currentVisibleDate","onChangeCurrentVisibleDate","renderAdditionalControls","inputRef","name","placeholder","dropdownClassName","dropdownRef","timeOptions","onDropdownOpen","dropdownOpen","ignoreOutsideClicksRefs","disabled","disableDates","dropdownViewportRef"];import startOfMonth from"date-fns/startOfMonth";import React,{forwardRef,useCallback,useEffect,useRef,useState}from"react";import{useClickOutside}from"../../../hooks/useClickOutside/useClickOutside";import{useForkRef}from"../../../hooks/useForkRef/useForkRef";import{DatePickerDropdown}from"../DatePickerDropdown/DatePickerDropdown";import{DatePickerFieldTypeDateTimeRange}from"../DatePickerFieldTypeDateTimeRange/DatePickerFieldTypeDateTimeRange";import{datePickerPropFormatTypeDateTime,getDropdownZIndex,getFieldName,getTimeOptionsByFormat,normalizeRangeValue}from"../helpers";import{getTimeFof}from"../timeForMap";import{useCalendarVisible}from"../useCalendarVisible";import{useCurrentVisibleDate}from"../useCurrentVisibleDate";export var DatePickerTypeDateTimeRange=forwardRef(function(a,b){var c,d,e,f,g=a.events,h=a.dateTimeView,i=a.locale,j=a.dropdownForm,k=a.onFocus,l=a.onBlur,m=a.leftSide,n=a.rightSide,o=a.currentVisibleDate,p=a.onChangeCurrentVisibleDate,q=a.renderAdditionalControls,r=a.inputRef,s=a.name,t=a.placeholder,u=a.dropdownClassName,v=a.dropdownRef,w=a.timeOptions,x=a.onDropdownOpen,y=a.dropdownOpen,z=a.ignoreOutsideClicksRefs,A=a.disabled,B=a.disableDates,C=a.dropdownViewportRef,D=_objectWithoutProperties(a,_excluded),E=useRef(null),F=useRef(null),G=useRef(null),H=useRef(null),I=useRef(null),J=useState(),K=_slicedToArray(J,2),L=K[0],M=K[1],N=0===L,O=1===L,P=getTimeOptionsByFormat(D.format||datePickerPropFormatTypeDateTime,w),Q=useCalendarVisible({dropdownOpen:y,onDropdownOpen:x,disabled:A,startRef:G,endRef:H}),R=_slicedToArray(Q,2),S=R[0],T=R[1],U=useCurrentVisibleDate({currentVisibleDate:o,maxDate:a.maxDate,minDate:a.minDate,value:a.value,startOfUnit:startOfMonth,onChangeCurrentVisibleDate:p,calendarVisible:S,rangeIndex:L}),V=_slicedToArray(U,2),W=V[0],X=V[1];return useEffect(function(){var b;if(null!==(b=a.value)&&void 0!==b&&b[0]&&N){var c=startOfMonth(a.value[0]);c.getTime()!==(null===W||void 0===W?void 0:W.getTime())&&X(c)}},[null===(c=a.value)||void 0===c||null===(d=c[0])||void 0===d?void 0:d.getTime(),S,N]),useEffect(function(){var b;if(null!==(b=a.value)&&void 0!==b&&b[1]&&O){var c=startOfMonth(a.value[1]);c.getTime()!==(null===W||void 0===W?void 0:W.getTime())&&X(c)}},[null===(e=a.value)||void 0===e||null===(f=e[1])||void 0===f?void 0:f.getTime(),S,O]),useClickOutside({isActive:S,ignoreClicksInsideRefs:[E,F,I].concat(_toConsumableArray(null!==z&&void 0!==z?z:[])),handler:useCallback(function(){M(void 0),T.off()},[])}),React.createElement(React.Fragment,null,React.createElement(DatePickerFieldTypeDateTimeRange,Object.assign({},D,{ref:b,startFieldRef:E,endFieldRef:F,startFieldInputRef:useForkRef([G,null===r||void 0===r?void 0:r[0]]),endFieldInputRef:useForkRef([H,null===r||void 0===r?void 0:r[1]]),startFieldOnFocus:function startFieldOnFocusHandler(a){var b;M(0),Array.isArray(k)?null===(b=k[0])||void 0===b?void 0:b.call(k,a):null===k||void 0===k?void 0:k(a)},endFieldOnFocus:function endFieldOnFocusHandler(a){var b;M(1),Array.isArray(k)?null===(b=k[1])||void 0===b?void 0:b.call(k,a):null===k||void 0===k?void 0:k(a)},startFieldLeftSide:Array.isArray(m)?null===m||void 0===m?void 0:m[0]:m,startFieldRightSide:Array.isArray(n)?null===n||void 0===n?void 0:n[0]:void 0,endFieldLeftSide:Array.isArray(m)?null===m||void 0===m?void 0:m[1]:void 0,endFieldRightSide:Array.isArray(n)?null===n||void 0===n?void 0:n[1]:n,startFieldOnBlur:function startFieldOnBlurHandler(a){var b;return Array.isArray(l)?null===(b=l[0])||void 0===b?void 0:b.call(l,a):null===l||void 0===l?void 0:l(a)},endFieldOnBlur:function endFieldOnBlurHandler(a){var b;return Array.isArray(l)?null===(b=l[1])||void 0===b?void 0:b.call(l,a):null===l||void 0===l?void 0:l(a)},startFieldOnClick:T.on,endFieldOnClick:T.on,startFocused:N,endFocused:O,startFieldName:getFieldName(s,0),endFieldName:getFieldName(s,1),disabled:A,startFieldPlaceholder:Array.isArray(t)?null===t||void 0===t?void 0:t[0]:t,endFieldPlaceholder:Array.isArray(t)?null===t||void 0===t?void 0:t[1]:t,timeOptions:P})),React.createElement(DatePickerDropdown,{type:"date-time",ref:useForkRef([v,I]),viewportRef:C,anchorRef:E,isOpen:S,className:u,onChangeCurrentVisibleDate:X,currentVisibleDate:W,value:a.value||void 0,timeFor:getTimeFof(L),view:"classic",events:g,locale:i,minDate:a.minDate,maxDate:a.maxDate,form:j,onChange:function handleChange(b,c){var d=c.e;if(N){var e,f,g=normalizeRangeValue([b,null===a||void 0===a||null===(e=a.value)||void 0===e?void 0:e[1]]);null===(f=a.onChange)||void 0===f?void 0:f.call(a,g,{e:d})}if(O){var h,i,j=normalizeRangeValue([null===a||void 0===a||null===(h=a.value)||void 0===h?void 0:h[0],b]);null===(i=a.onChange)||void 0===i?void 0:i.call(a,j,{e:d})}},renderAdditionalControls:q,timeOptions:P,zIndex:getDropdownZIndex(a.style),disableDates:B}))});
//# sourceMappingURL=DatePickerTypeDateTimeRange.js.map