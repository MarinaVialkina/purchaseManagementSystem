{"version":3,"file":"SelectItemAll.js","names":["useAtom","React","forwardRef","Checkbox","ListItem","Text","cnCanary","cn","sizeCheckboxMap","cnSelectItemAll","textSizeMap","xs","s","m","l","SelectItemAllCounter","groupsCounterAtom","groupId","size","ctx","counter","spy","total","selected","SelectItemAllCounterCheckbox","checked","intermediate","SelectItemAll","props","ref","indent","className","highlightedIndexAtom","index","label","otherProps","hovered"],"sources":["../../../../../../src/components/SelectCanary/SelectItemAll/SelectItemAll.tsx"],"sourcesContent":["import { AtomMut } from '@reatom/framework';\nimport { useAtom } from '@reatom/npm-react';\nimport React, { forwardRef } from 'react';\n\nimport { Checkbox } from '##/components/Checkbox';\nimport { FieldPropSize } from '##/components/FieldComponents';\nimport { ListItem } from '##/components/ListCanary';\nimport { Text, TextPropSize } from '##/components/Text';\nimport { cnCanary as cn } from '##/utils/bem';\nimport { PropsWithHTMLAttributesAndRef } from '##/utils/types/PropsWithHTMLAttributes';\n\nimport { sizeCheckboxMap } from '../SelectItem';\n\nexport type SelectItemAllProps = PropsWithHTMLAttributesAndRef<\n  {\n    size: FieldPropSize;\n    hovered?: boolean;\n    indent?: 'normal' | 'increased';\n    groupsCounterAtom: AtomMut<Record<string, [number, number]>>;\n    groupId: string | number;\n    highlightedIndexAtom: AtomMut<number>;\n    index: number;\n    label: string;\n  },\n  HTMLDivElement\n>;\n\nexport const cnSelectItemAll = cn('SelectItemAll');\n\nconst textSizeMap: Record<FieldPropSize, TextPropSize> = {\n  xs: 's',\n  s: 's',\n  m: 'm',\n  l: 'l',\n};\n\nconst SelectItemAllCounter: React.FC<{\n  groupsCounterAtom: AtomMut<Record<string, [number, number]>>;\n  groupId: string | number;\n  size: FieldPropSize;\n}> = ({ groupsCounterAtom, groupId, size }) => {\n  const [total] = useAtom((ctx) => {\n    const counter = ctx.spy(groupsCounterAtom);\n    return counter[groupId]?.[1] || 0;\n  });\n  const [selected] = useAtom((ctx) => {\n    const counter = ctx.spy(groupsCounterAtom);\n    return counter[groupId]?.[0] || 0;\n  });\n\n  return (\n    <Text\n      size={textSizeMap[size]}\n      lineHeight=\"xs\"\n      view=\"ghost\"\n    >{`${selected} из ${total}`}</Text>\n  );\n};\n\nconst SelectItemAllCounterCheckbox: React.FC<{\n  groupsCounterAtom: AtomMut<Record<string, [number, number]>>;\n  groupId: string | number;\n  size: FieldPropSize;\n}> = ({ groupsCounterAtom, groupId, size }) => {\n  const [checked] = useAtom((ctx) => {\n    const counter = ctx.spy(groupsCounterAtom);\n    if (counter[groupId] === undefined) {\n      return false;\n    }\n    return counter[groupId][0] === counter[groupId][1];\n  });\n  const [intermediate] = useAtom((ctx) => {\n    const counter = ctx.spy(groupsCounterAtom);\n    if (counter[groupId] === undefined) {\n      return false;\n    }\n    return counter[groupId][0] > 0 && counter[groupId][0] < counter[groupId][1];\n  });\n\n  return (\n    <Checkbox\n      checked={checked}\n      intermediate={intermediate}\n      size={sizeCheckboxMap[size]}\n    />\n  );\n};\n\nexport const SelectItemAll: React.FC<SelectItemAllProps> = forwardRef(\n  (props, ref) => {\n    const {\n      size,\n      indent,\n      className,\n      groupsCounterAtom,\n      groupId,\n      highlightedIndexAtom,\n      index,\n      label,\n      ...otherProps\n    } = props;\n\n    const [hovered] = useAtom((ctx) => ctx.spy(highlightedIndexAtom) === index);\n\n    return (\n      <ListItem\n        {...otherProps}\n        ref={ref}\n        className={cnSelectItemAll(null, [className])}\n        role=\"option\"\n        label={label}\n        innerOffset={indent}\n        size={size}\n        active={hovered}\n        rightSide={\n          <SelectItemAllCounter\n            size={size}\n            groupsCounterAtom={groupsCounterAtom}\n            groupId={groupId}\n          />\n        }\n        leftSide={\n          <SelectItemAllCounterCheckbox\n            size={size}\n            groupsCounterAtom={groupsCounterAtom}\n            groupId={groupId}\n          />\n        }\n      />\n    );\n  },\n);\n"],"mappings":"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"}