{"version":3,"file":"SelectMultiple.js","names":["useAction","React","forwardRef","useRef","FieldArrayValueItem","SelectDropdown","SelectItem","useForkRef","cnCanary","cn","useSendToAtom","withCtx","withDefault","SelectControlLayout","SelectMultipleValue","useSelect","cnSelectMultiple","SelectMultipleRender","props","ref","propsWithDefault","propsAtom","form","status","size","disabled","value","renderValue","isLoading","dropdownRefProp","dropdownRef","dropdownForm","renderItem","getGroupLabel","labelForCreate","labelForEmptyItems","virtualScroll","onScrollToBottom","style","className","placeholder","view","iconClear","input","inputValue","inputDefaultValue","inputRefProp","inputRef","getGroupKey","getItemDisabled","getItemGroupKey","getItemKey","getItemLabel","items","onChangeProp","onChange","dropdownClassName","onFocus","onBlur","onCreateProp","onCreate","onInput","multiple","groups","onDropdownOpen","ignoreOutsideClicksRefs","clearButton","selectAll","selectAllLabel","dropdownViewportRef","otherProps","getOptionActions","openAtom","visibleItemsAtom","focusAtom","handleInputFocus","handleInputBlur","handleToggleDropdown","handleInputClick","handleInputChange","clearValue","optionsRefs","controlRef","clearButtonAtom","highlightedIndexAtom","getItemKeyAtom","valueAtom","onChangeAll","highlightIndex","inputValueAtom","getHandleRemoveValue","hasItemsAtom","groupsCounterAtom","dropdownZIndexAtom","valueContainerRef","renderItemDefault","ctx","item","active","hovered","onClick","onMouseEnter","inlineControlRender","renderValueDefault","getRemove","map","itemDisabled","SelectMultiple"],"sources":["../../../../../../src/components/SelectCanary/SelectMultiple/SelectMultiple.tsx"],"sourcesContent":["import './SelectMultiple.css';\n\nimport { useAction } from '@reatom/npm-react';\nimport React, { forwardRef, useRef } from 'react';\n\nimport { FieldArrayValueItem } from '##/components/FieldComponents';\nimport { SelectDropdown } from '##/components/SelectCanary/SelectDropdown';\nimport { SelectItem } from '##/components/SelectCanary/SelectItem';\nimport { useForkRef } from '##/hooks/useForkRef';\nimport { cnCanary as cn } from '##/utils/bem';\nimport { useSendToAtom } from '##/utils/state';\nimport { withCtx } from '##/utils/state/withCtx';\n\nimport {\n  RenderItemProps,\n  SelectComponent,\n  SelectGroupDefault,\n  SelectItemDefault,\n  SelectPropRenderItem,\n  SelectProps,\n} from '..';\nimport { withDefault } from '../defaultProps';\nimport { SelectControlLayout } from '../SelectControlLayout';\nimport { SelectMultipleValue } from '../SelectMultipleValue';\nimport { useSelect } from '../useSelect';\n\nconst cnSelectMultiple = cn('SelectMultiple');\n\nconst SelectMultipleRender = <\n  ITEM = SelectItemDefault,\n  GROUP = SelectGroupDefault,\n>(\n  props: SelectProps<ITEM, GROUP, true>,\n  ref: React.Ref<HTMLDivElement>,\n) => {\n  const propsWithDefault = withDefault(props);\n\n  const propsAtom = useSendToAtom(propsWithDefault);\n\n  const {\n    form,\n    status,\n    size,\n    disabled,\n    value,\n    renderValue,\n    isLoading,\n    dropdownRef: dropdownRefProp,\n    dropdownForm,\n    renderItem,\n    getGroupLabel,\n    labelForCreate,\n    labelForEmptyItems,\n    virtualScroll,\n    onScrollToBottom,\n    style,\n    className,\n    placeholder,\n    view,\n    iconClear,\n    input,\n    inputValue,\n    inputDefaultValue,\n    inputRef: inputRefProp,\n\n    // исключаем из otherProps\n    getGroupKey,\n    getItemDisabled,\n    getItemGroupKey,\n    getItemKey,\n    getItemLabel,\n    items,\n    onChange: onChangeProp,\n    dropdownClassName,\n    onFocus,\n    onBlur,\n    onCreate: onCreateProp,\n    onInput,\n    multiple,\n    groups,\n    onDropdownOpen,\n    ignoreOutsideClicksRefs,\n    clearButton,\n    selectAll,\n    selectAllLabel,\n    dropdownViewportRef,\n    ...otherProps\n  } = propsWithDefault;\n\n  const {\n    getOptionActions,\n    openAtom,\n    visibleItemsAtom,\n    focusAtom,\n    handleInputFocus,\n    handleInputBlur,\n    handleToggleDropdown,\n    inputRef,\n    handleInputClick,\n    handleInputChange,\n    clearValue,\n    optionsRefs,\n    controlRef,\n    dropdownRef,\n    clearButtonAtom,\n    highlightedIndexAtom,\n    getItemKeyAtom,\n    valueAtom,\n    onChangeAll,\n    highlightIndex,\n    onCreate,\n    onChange,\n    inputValueAtom,\n    getHandleRemoveValue,\n    hasItemsAtom,\n    groupsCounterAtom,\n    dropdownZIndexAtom,\n  } = useSelect<ITEM, GROUP, true>({\n    propsAtom,\n  });\n\n  const valueContainerRef = useRef<HTMLDivElement>(null);\n\n  const renderItemDefault: SelectPropRenderItem<ITEM> = useAction(\n    (\n      ctx,\n      {\n        item,\n        active,\n        hovered,\n        onClick,\n        onMouseEnter,\n        ref,\n      }: RenderItemProps<ITEM>,\n    ) => {\n      return (\n        <SelectItem\n          label={getItemLabel(item)}\n          active={active}\n          hovered={hovered}\n          size={size}\n          indent={dropdownForm === 'round' ? 'increased' : 'normal'}\n          onClick={onClick}\n          onMouseEnter={onMouseEnter}\n          disabled={getItemDisabled(item)}\n          ref={ref}\n          multiple\n        />\n      );\n    },\n    [getItemDisabled, size, getItemLabel, dropdownForm],\n  );\n\n  const inlineControlRender = useAction(\n    (ctx, value: ITEM[]) => {\n      const renderValueDefault = ({\n        value,\n        getRemove,\n      }: {\n        value: ITEM[];\n        getRemove: (\n          item: ITEM,\n        ) => (e: React.SyntheticEvent<Element, Event>) => void;\n      }) => {\n        return value.map((item) => {\n          const itemDisabled = disabled || getItemDisabled(item);\n          return (\n            <FieldArrayValueItem\n              key={getItemKey(item)}\n              size={size}\n              label={getItemLabel(item)}\n              disabled={itemDisabled}\n              onRemove={itemDisabled ? undefined : getRemove(item)}\n            />\n          );\n        });\n      };\n\n      return (renderValue || renderValueDefault)({\n        value,\n        getRemove: getHandleRemoveValue,\n      });\n    },\n    [disabled, getItemDisabled, getItemKey, size, getItemLabel, renderValue],\n  );\n\n  return (\n    <>\n      <SelectControlLayout\n        {...otherProps}\n        style={style}\n        className={cnSelectMultiple(null, [className])}\n        form={form}\n        status={status}\n        size={size}\n        disabled={disabled}\n        separator\n        onClear={clearValue}\n        onDropdownButton={handleToggleDropdown}\n        openAtom={openAtom}\n        focusAtom={focusAtom}\n        view={view}\n        iconClear={iconClear}\n        clearButtonAtom={clearButtonAtom}\n        ref={useForkRef([ref, controlRef])}\n      >\n        <SelectMultipleValue\n          propsAtom={propsAtom}\n          onFocus={handleInputFocus}\n          onBlur={handleInputBlur}\n          onClick={handleInputClick}\n          onChange={handleInputChange}\n          renderValue={inlineControlRender}\n          inputRef={useForkRef([inputRef, inputRefProp])}\n          ref={valueContainerRef}\n        />\n      </SelectControlLayout>\n      <SelectDropdown\n        valueAtom={valueAtom}\n        getItemKeyAtom={getItemKeyAtom}\n        openAtom={openAtom}\n        size={size}\n        controlRef={controlRef}\n        getOptionActions={getOptionActions}\n        dropdownRef={useForkRef([dropdownRef, dropdownRefProp])}\n        form={dropdownForm}\n        className={dropdownClassName}\n        renderItem={renderItem || renderItemDefault}\n        getGroupLabel={getGroupLabel}\n        visibleItemsAtom={visibleItemsAtom}\n        labelForCreate={labelForCreate}\n        isLoading={isLoading}\n        labelForEmptyItems={labelForEmptyItems}\n        itemsRefs={optionsRefs}\n        virtualScroll={virtualScroll}\n        onScrollToBottom={onScrollToBottom}\n        highlightedIndexAtom={highlightedIndexAtom}\n        highlightIndex={highlightIndex}\n        onChangeAll={onChangeAll}\n        onCreate={onCreate}\n        onChange={onChange}\n        inputValueAtom={inputValueAtom}\n        hasItemsAtom={hasItemsAtom}\n        groupsCounterAtom={groupsCounterAtom}\n        dropdownZIndexAtom={dropdownZIndexAtom}\n        selectAllLabel={selectAllLabel}\n        viewportRef={dropdownViewportRef}\n      />\n    </>\n  );\n};\n\nexport const SelectMultiple = withCtx(\n  forwardRef(SelectMultipleRender),\n) as SelectComponent;\n"],"mappings":"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"}