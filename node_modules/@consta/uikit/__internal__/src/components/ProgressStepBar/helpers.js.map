{"version":3,"file":"helpers.js","names":["cn","progressStepBarPropSize","progressStepBarPropSizeDefault","progressStepBarPropDirection","progressStepBarPropDirectionDefault","progressStepBarPropStatus","progressStepBarPropStatusDefault","progressStepBarPointNumbersMap","progressStepBarPropPosition","progressStepBarPropPositionDefault","cnProgressStepBar","defaultGetItemLabel","item","label","defaultGetItemTooltipContent","tooltipContent","defaultGetItemPoint","point","defaultGetItemLineStatus","lineStatus","defaultGetItemProgress","progress","defaultGetItemContent","content","defaultGetItemStatus","status","defaultGetItemOnClick","onClick","withDefaultGetters","props","getItemLabel","getItemTooltipContent","getItemPoint","getItemProgress","getItemContent","getItemStatus","getItemLineStatus","getItemOnClick","getItemPosition","index","length","position","getRefSize","ref","current","getBoundingClientRect","width","height","calculateLines","refs","direction","sizes","i","width1","height1","width2","size","first","second","push","validateVisibleIndex","Math","min"],"sources":["../../../../../src/components/ProgressStepBar/helpers.ts"],"sourcesContent":["import { IconComponent } from '@consta/icons/Icon';\nimport React from 'react';\n\nimport { cn } from '../../utils/bem';\nimport { PropsWithHTMLAttributesAndRef } from '../../utils/types/PropsWithHTMLAttributes';\n\nexport const progressStepBarPropSize = ['s', 'xs', 'm'] as const;\nexport type ProgressStepBarPropSize = typeof progressStepBarPropSize[number];\nexport const progressStepBarPropSizeDefault = progressStepBarPropSize[0];\n\nexport const progressStepBarPropDirection = ['horizontal', 'vertical'] as const;\nexport type ProgressStepBarPropDirection =\n  typeof progressStepBarPropDirection[number];\nexport const progressStepBarPropDirectionDefault =\n  progressStepBarPropDirection[0];\n\nexport const progressStepBarPropStatus = [\n  'normal',\n  'success',\n  'warning',\n  'alert',\n] as const;\nexport type ProgressStepBarPropStatus =\n  typeof progressStepBarPropStatus[number];\nexport const progressStepBarPropStatusDefault = progressStepBarPropStatus[0];\n\nexport const progressStepBarPointNumbersMap = [\n  0, 1, 2, 3, 4, 5, 6, 7, 8, 9,\n] as const;\nexport type ProgressStepBarPointNumbersMap =\n  typeof progressStepBarPointNumbersMap[number];\n\nexport const progressStepBarPropPosition = ['center', 'start', 'end'] as const;\nexport type ProgressStepBarPropPosition =\n  typeof progressStepBarPropPosition[number];\nexport const progressStepBarPropPositionDefault: ProgressStepBarPropPosition =\n  progressStepBarPropPosition[0];\n\nexport type ProgressStepBarPropGetItemLabel<ITEM> = (\n  item: ITEM,\n) => string | undefined;\nexport type ProgressStepBarPropGetItemKey<ITEM> = (\n  item: ITEM,\n) => string | number;\nexport type ProgressStepBarPropGetItemTooltipContent<ITEM> = (\n  item: ITEM,\n) => string | undefined;\nexport type ProgressStepBarPropGetItemLineStatus<ITEM> = (\n  item: ITEM,\n) => ProgressStepBarPropStatus | undefined;\nexport type ProgressStepBarPropGetItemPoint<ITEM> = (\n  item: ITEM,\n) => ProgressStepBarPointNumbersMap | IconComponent | undefined;\nexport type ProgressStepBarPropGetItemProgress<ITEM> = (\n  item: ITEM,\n) => boolean | undefined;\nexport type ProgressStepBarPropGetItemContent<ITEM> = (\n  item: ITEM,\n) => React.ReactNode | undefined;\nexport type ProgressStepBarPropGetItemStatus<ITEM> = (\n  item: ITEM,\n) => ProgressStepBarPropStatus | undefined;\nexport type ProgressStepBarPropGetItemOnClick<ITEM> = (\n  item: ITEM,\n) => React.EventHandler<React.MouseEvent> | undefined;\n\nexport type ProgressStepBarItemDefault = {\n  label?: string;\n  tooltipContent?: string;\n  lineStatus?: ProgressStepBarPropStatus;\n  point?: ProgressStepBarPointNumbersMap | IconComponent;\n  status?: ProgressStepBarPropStatus;\n  progress?: boolean;\n  content?: React.ReactNode;\n  onClick?: React.EventHandler<React.MouseEvent>;\n};\n\nexport type Line = {\n  status: ProgressStepBarPropStatus;\n  size: number;\n};\n\nexport type ProgressStepBarPropOnItemClick<ITEM> = (\n  item: ITEM,\n  props: {\n    e: React.MouseEvent;\n    index: number;\n  },\n) => void;\n\nexport type ProgressStepBarProps<ITEM = ProgressStepBarItemDefault> =\n  PropsWithHTMLAttributesAndRef<\n    {\n      steps: ITEM[];\n      direction?: ProgressStepBarPropDirection;\n      size?: ProgressStepBarPropSize;\n      activeStepIndex?: number;\n      onItemClick?: ProgressStepBarPropOnItemClick<ITEM>;\n      getItemLabel?: ProgressStepBarPropGetItemLabel<ITEM>;\n      getItemLineStatus?: ProgressStepBarPropGetItemLineStatus<ITEM>;\n      getItemTooltipContent?: ProgressStepBarPropGetItemTooltipContent<ITEM>;\n      getItemPoint?: ProgressStepBarPropGetItemPoint<ITEM>;\n      getItemProgress?: ProgressStepBarPropGetItemProgress<ITEM>;\n      getItemContent?: ProgressStepBarPropGetItemContent<ITEM>;\n      getItemStatus?: ProgressStepBarPropGetItemStatus<ITEM>;\n      getItemOnClick?: ProgressStepBarPropGetItemOnClick<ITEM>;\n    },\n    HTMLDivElement\n  > &\n    (ITEM extends { label: ProgressStepBarItemDefault['label'] }\n      ? {}\n      : { getItemLabel: ProgressStepBarPropGetItemLabel<ITEM> });\n\nexport type ProgressStepBarItemProps = {\n  content?: React.ReactNode;\n  label?: string;\n  point?: ProgressStepBarPointNumbersMap | IconComponent;\n  progress?: boolean;\n  status?: ProgressStepBarPropStatus | 'system';\n  tooltipContent?: string;\n  tooltipZIndex?: number;\n  position?: ProgressStepBarPropPosition;\n  direction: ProgressStepBarPropDirection;\n  size: ProgressStepBarPropSize;\n  onClick?: (e: React.MouseEvent) => void;\n  pointRef?: React.RefObject<HTMLButtonElement>;\n  className?: string;\n};\n\nexport const cnProgressStepBar = cn('ProgressStepBar');\n\nexport const defaultGetItemLabel: ProgressStepBarPropGetItemLabel<\n  ProgressStepBarItemDefault\n> = (item) => item.label;\nexport const defaultGetItemTooltipContent: ProgressStepBarPropGetItemTooltipContent<\n  ProgressStepBarItemDefault\n> = (item) => item.tooltipContent;\nexport const defaultGetItemPoint: ProgressStepBarPropGetItemPoint<\n  ProgressStepBarItemDefault\n> = (item) => item.point;\nexport const defaultGetItemLineStatus: ProgressStepBarPropGetItemLineStatus<\n  ProgressStepBarItemDefault\n> = (item) => item.lineStatus;\nexport const defaultGetItemProgress: ProgressStepBarPropGetItemProgress<\n  ProgressStepBarItemDefault\n> = (item) => item.progress;\nexport const defaultGetItemContent: ProgressStepBarPropGetItemContent<\n  ProgressStepBarItemDefault\n> = (item) => item.content;\nexport const defaultGetItemStatus: ProgressStepBarPropGetItemStatus<\n  ProgressStepBarItemDefault\n> = (item) => item.status;\nexport const defaultGetItemOnClick: ProgressStepBarPropGetItemOnClick<\n  ProgressStepBarItemDefault\n> = (item) => item.onClick;\n\nexport type ProgressStepBarComponent = <ITEM = ProgressStepBarItemDefault>(\n  props: ProgressStepBarProps<ITEM>,\n) => React.ReactNode | null;\n\nexport type ProgressStepBarItemComponent = (\n  props: PropsWithHTMLAttributesAndRef<\n    ProgressStepBarItemProps,\n    HTMLDivElement\n  >,\n) => React.ReactNode | null;\n\nexport function withDefaultGetters<ITEM>(props: ProgressStepBarProps<ITEM>) {\n  return {\n    ...props,\n    getItemLabel: props.getItemLabel || defaultGetItemLabel,\n    getItemTooltipContent:\n      props.getItemTooltipContent || defaultGetItemTooltipContent,\n    getItemPoint: props.getItemPoint || defaultGetItemPoint,\n    getItemProgress: props.getItemProgress || defaultGetItemProgress,\n    getItemContent: props.getItemContent || defaultGetItemContent,\n    getItemStatus: props.getItemStatus || defaultGetItemStatus,\n    getItemLineStatus: props.getItemLineStatus || defaultGetItemLineStatus,\n    getItemOnClick: props.getItemOnClick || defaultGetItemOnClick,\n  };\n}\n\nexport const getItemPosition = (index: number, length: number) => {\n  let position: ProgressStepBarPropPosition = 'center';\n  if (index === length - 1) position = 'end';\n  if (index === 0) position = 'start';\n\n  return position;\n};\n\nconst getRefSize = (ref: React.RefObject<HTMLElement>) => {\n  if (ref.current) {\n    const { width, height } = ref.current.getBoundingClientRect();\n    return [width, height];\n  }\n  return [0, 0];\n};\n\nexport const calculateLines = (\n  refs: React.RefObject<HTMLElement>[],\n  direction: ProgressStepBarPropDirection,\n) => {\n  const sizes: number[] = [];\n  const { length } = refs;\n\n  if (length < 2) {\n    return sizes;\n  }\n\n  for (let i = 0; i < length - 1; i++) {\n    const [width1, height1] = getRefSize(refs[i]);\n    const [width2] = getRefSize(refs[i + 1]);\n\n    let size = 0;\n    if (direction === 'horizontal') {\n      const first = i === 0 ? width1 : width1 / 2;\n      const second = i === length - 2 ? width2 : width2 / 2;\n      size = first + second;\n    } else {\n      size = height1;\n      if (i === length - 2) {\n        size += 2;\n      }\n    }\n    sizes.push(size);\n  }\n\n  return sizes;\n};\n\nexport const validateVisibleIndex = (\n  length: number,\n  index: number | undefined,\n) => {\n  if (!index) {\n    return index;\n  }\n\n  if (index < 0) {\n    return undefined;\n  }\n\n  return Math.min(index, length - 1);\n};\n"],"mappings":"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"}