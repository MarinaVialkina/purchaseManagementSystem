{"version":3,"file":"AutoComplete.js","names":["React","useCallback","useRef","SelectDropdown","SelectItem","defaultPropForm","defaultPropSize","defaultPropView","TextField","useForkRef","useMutableRef","cn","withDefaultGetters","useAutoComplete","cnAutoComplete","AutoCompleteRender","props","ref","defaultDropdownRef","controlRef","containerRef","items","groups","disabled","getItemLabel","getItemKey","isLoading","getItemGroupKey","getGroupKey","getGroupLabel","onBlur","inputRef","onFocus","dropdownRef","dropdownClassName","dropdownForm","value","form","view","size","onChange","inputContainerRef","style","renderItem","searchFunction","id","name","className","virtualScroll","onScrollToBottom","onDropdownOpen","dropdownOpen","ignoreOutsideClicksRefs","rows","minRows","maxRows","dropdownViewportRef","otherProps","onChangeRef","handleSelectChange","e","copyEvent","newValue","current","toString","handleInputChange","searchValue","getOptionProps","isOpen","getKeyProps","visibleItems","handleInputFocus","handleInputBlur","inputControlRef","optionsRefs","renderItemDefault","item","active","hovered","onClick","onMouseEnter","length","zIndex","AutoComplete","forwardRef"],"sources":["../../../../../src/components/AutoComplete/AutoComplete.tsx"],"sourcesContent":["import React, { useCallback, useRef } from 'react';\n\nimport { PropRenderItem } from '##/components/Select';\nimport { SelectDropdown } from '##/components/SelectComponents/SelectDropdown';\nimport { SelectItem } from '##/components/SelectComponents/SelectItem';\nimport {\n  defaultPropForm,\n  defaultPropSize,\n  defaultPropView,\n} from '##/components/SelectComponentsDeprecated/types';\nimport {\n  TextField,\n  TextFieldPropOnChange,\n} from '##/components/TextField/TextField';\nimport { useForkRef } from '##/hooks/useForkRef';\nimport { useMutableRef } from '##/hooks/useMutableRef';\nimport { cn } from '##/utils/bem';\n\nimport { withDefaultGetters } from './helpers';\nimport {\n  AutoCompleteComponent,\n  AutoCompleteGroupDefault,\n  AutoCompleteItemDefault,\n  AutoCompleteProps,\n} from './types';\nimport { useAutoComplete } from './useAutoComplete';\n\nconst cnAutoComplete = cn('AutoComplete');\n\nconst AutoCompleteRender = <\n  TYPE extends string,\n  ITEM = AutoCompleteItemDefault,\n  GROUP = AutoCompleteGroupDefault,\n>(\n  props: AutoCompleteProps<TYPE, ITEM, GROUP>,\n  ref: React.Ref<HTMLDivElement>,\n) => {\n  const defaultDropdownRef = useRef<HTMLDivElement | null>(null);\n  const controlRef = useRef<HTMLDivElement>(null);\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  const {\n    items,\n    groups = [],\n    disabled,\n    getItemLabel,\n    getItemKey,\n    isLoading,\n    getItemGroupKey,\n    getGroupKey,\n    getGroupLabel,\n    onBlur,\n    inputRef,\n    onFocus,\n    dropdownRef = defaultDropdownRef,\n    dropdownClassName,\n    dropdownForm = 'default',\n    value,\n    form = defaultPropForm,\n    view = defaultPropView,\n    size = defaultPropSize,\n    onChange,\n    inputContainerRef,\n    style,\n    renderItem,\n    searchFunction,\n    id,\n    name,\n    className,\n    virtualScroll,\n    onScrollToBottom,\n    onDropdownOpen,\n    dropdownOpen,\n    ignoreOutsideClicksRefs,\n    rows,\n    minRows,\n    maxRows,\n    dropdownViewportRef,\n    ...otherProps\n  } = withDefaultGetters(props);\n\n  const onChangeRef = useMutableRef(onChange);\n\n  const handleSelectChange = useCallback(\n    ({ e, value }: { value: ITEM | null; e: React.SyntheticEvent }) => {\n      const copyEvent = { ...e } as React.KeyboardEvent;\n      const newValue = (value ? getItemLabel(value) : value) as string;\n      onChangeRef.current?.(newValue, {\n        e: copyEvent,\n        id: id?.toString(),\n        name,\n      });\n    },\n    [id, name],\n  );\n\n  const handleInputChange: TextFieldPropOnChange = useCallback(\n    (value, { id, name, e }) => {\n      onChangeRef.current?.(value, { id: id?.toString(), name, e });\n    },\n    [],\n  );\n\n  const {\n    getOptionProps,\n    isOpen,\n    getKeyProps,\n    visibleItems,\n    handleInputFocus,\n    handleInputBlur,\n    inputRef: inputControlRef,\n    optionsRefs,\n  } = useAutoComplete({\n    items,\n    groups,\n    onChange: handleSelectChange,\n    dropdownRef,\n    controlRef,\n    disabled,\n    searchValue: value ?? '',\n    getItemLabel,\n    getItemKey,\n    getItemGroupKey,\n    getGroupKey,\n    onBlur,\n    onFocus,\n    searchFunction,\n    isLoading,\n    onDropdownOpen,\n    dropdownOpen,\n    ignoreOutsideClicksRefs,\n  });\n\n  const renderItemDefault: PropRenderItem<ITEM> = (props) => {\n    const { item, active, hovered, onClick, onMouseEnter, ref } = props;\n\n    return (\n      <SelectItem\n        label={getItemLabel(item)}\n        active={active}\n        hovered={hovered}\n        multiple={false}\n        disabled={disabled}\n        size={size}\n        indent={dropdownForm === 'round' ? 'increased' : 'normal'}\n        onClick={onClick}\n        onMouseEnter={onMouseEnter}\n        ref={ref}\n      />\n    );\n  };\n\n  return (\n    <>\n      <TextField\n        {...getKeyProps()}\n        form={form}\n        view={view}\n        id={id}\n        className={cnAutoComplete(null, [className])}\n        name={name}\n        disabled={disabled}\n        ref={useForkRef([controlRef, ref])}\n        inputRef={useForkRef([\n          inputRef as React.RefObject<HTMLInputElement>,\n          inputControlRef,\n        ])}\n        onBlur={handleInputBlur}\n        inputContainerRef={useForkRef([containerRef, inputContainerRef])}\n        onClick={handleInputFocus}\n        onChange={handleInputChange}\n        value={value}\n        style={style}\n        size={size}\n        rows={rows as undefined}\n        minRows={minRows as undefined}\n        maxRows={maxRows as undefined}\n        {...otherProps}\n      />\n      <SelectDropdown\n        viewportRef={dropdownViewportRef}\n        isOpen={isOpen}\n        size={size}\n        controlRef={containerRef}\n        getOptionProps={getOptionProps}\n        dropdownRef={dropdownRef}\n        form={dropdownForm}\n        className={cnAutoComplete('List', [dropdownClassName])}\n        renderItem={renderItem || renderItemDefault}\n        getGroupLabel={getGroupLabel}\n        visibleItems={visibleItems}\n        isLoading={isLoading}\n        hasItems={items.length !== 0}\n        itemsRefs={optionsRefs}\n        virtualScroll\n        style={\n          typeof style?.zIndex === 'number'\n            ? { zIndex: style.zIndex + 1 }\n            : undefined\n        }\n        onScrollToBottom={onScrollToBottom}\n      />\n    </>\n  );\n};\n\nexport const AutoComplete = React.forwardRef(\n  AutoCompleteRender,\n) as AutoCompleteComponent;\n\nexport * from './types';\n"],"mappings":"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"}