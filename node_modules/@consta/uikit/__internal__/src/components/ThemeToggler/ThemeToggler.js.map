{"version":3,"file":"ThemeToggler.js","names":["AnimateIconBaseProvider","IconCheck","withAnimateBaseHOC","React","forwardRef","useMemo","useRef","Button","ContextMenu","usePropsHandler","useChoiceGroup","useFlag","useForkRef","contextMenuSizeMap","iconSizeMap","withDefaultGetters","themeTogglerPropSizeDefault","COMPONENT_NAME","ThemeTogglerRender","props","ref","anchorRef","buttonRef","size","items","value","onChange","getItemKey","getItemLabel","getItemIcon","direction","possibleDirections","style","view","otherProps","isOpen","setIsOpen","getKey","callBack","multiple","getOnChange","getChecked","iconSize","contextMenuSize","Icon","icons","map","transition","length","findIndex","theme","onButtonClick","e","toggle","renderIcons","item","renderChecks","off","zIndex","ThemeToggler"],"sources":["../../../../../src/components/ThemeToggler/ThemeToggler.tsx"],"sourcesContent":["import { AnimateIconBaseProvider } from '@consta/icons/AnimateIconBaseProvider';\nimport { IconCheck } from '@consta/icons/IconCheck';\nimport { withAnimateBaseHOC } from '@consta/icons/withAnimateBaseHOC';\nimport React, { forwardRef, useMemo, useRef } from 'react';\n\nimport { Button } from '##/components/Button';\nimport { ContextMenu } from '##/components/ContextMenu';\nimport { usePropsHandler } from '##/components/EventInterceptor/usePropsHandler';\nimport { useChoiceGroup } from '##/hooks/useChoiceGroup';\nimport { useFlag } from '##/hooks/useFlag';\nimport { useForkRef } from '##/hooks/useForkRef';\n\nimport { contextMenuSizeMap, iconSizeMap, withDefaultGetters } from './helpers';\nimport {\n  ThemeTogglerComponent,\n  ThemeTogglerProps,\n  themeTogglerPropSizeDefault,\n} from './types';\n\nexport const COMPONENT_NAME = 'ThemeToggler' as const;\n\nconst ThemeTogglerRender = (\n  props: ThemeTogglerProps,\n  ref: React.Ref<HTMLButtonElement>,\n) => {\n  const anchorRef = useRef<HTMLButtonElement>(null);\n  const buttonRef = useForkRef([anchorRef, ref]);\n\n  const {\n    size = themeTogglerPropSizeDefault,\n    items,\n    value,\n    onChange,\n    getItemKey,\n    getItemLabel,\n    getItemIcon,\n    direction,\n    possibleDirections,\n    style,\n    view = 'clear',\n    ...otherProps\n  } = usePropsHandler(COMPONENT_NAME, withDefaultGetters(props), buttonRef);\n\n  const [isOpen, setIsOpen] = useFlag();\n\n  const { getOnChange, getChecked } = useChoiceGroup({\n    value,\n    getKey: getItemKey || getItemLabel,\n    callBack: onChange,\n    multiple: false,\n  });\n\n  type Item = typeof items[number];\n\n  const iconSize = iconSizeMap[size];\n  const contextMenuSize = contextMenuSizeMap[size];\n\n  const Icon = useMemo(\n    () =>\n      withAnimateBaseHOC({ icons: items.map(getItemIcon), transition: 260 }),\n    [items],\n  );\n\n  const onButtonClick = (e: React.MouseEvent<Element, MouseEvent>) => {\n    if (items.length > 2) {\n      setIsOpen.toggle();\n    } else {\n      getOnChange(items[getChecked(items[0]) ? 1 : 0])(e);\n    }\n  };\n\n  const renderIcons = (item: Item) => {\n    const Icon = getItemIcon(item);\n\n    if (Icon) {\n      return <Icon size={iconSize} />;\n    }\n  };\n\n  const renderChecks = (item: Item) => {\n    if (getChecked(item)) {\n      return <IconCheck size={iconSize} />;\n    }\n  };\n\n  if (items.length <= 1) {\n    return null;\n  }\n\n  return (\n    <>\n      <AnimateIconBaseProvider\n        activeIndex={items.findIndex((theme) => getChecked(theme)) ?? items[0]}\n      >\n        <Button\n          {...otherProps}\n          ref={buttonRef}\n          iconLeft={Icon}\n          onClick={onButtonClick}\n          onlyIcon\n          type=\"button\"\n          size={size}\n          view={view}\n          style={style}\n        />\n      </AnimateIconBaseProvider>\n      {items.length > 2 && (\n        <ContextMenu\n          isOpen={isOpen}\n          offset=\"s\"\n          items={items}\n          getItemLabel={getItemLabel}\n          getItemKey={getItemKey || getItemLabel}\n          anchorRef={anchorRef}\n          direction={direction}\n          possibleDirections={possibleDirections}\n          getItemLeftSide={renderIcons}\n          getItemRightSide={renderChecks}\n          onClickOutside={setIsOpen.off}\n          onItemClick={(item, { e }) => getOnChange(item)(e)}\n          size={contextMenuSize}\n          style={\n            typeof style?.zIndex === 'number'\n              ? { zIndex: style.zIndex + 1 }\n              : undefined\n          }\n        />\n      )}\n    </>\n  );\n};\n\nexport const ThemeToggler = forwardRef(\n  ThemeTogglerRender,\n) as ThemeTogglerComponent;\n\nexport * from './types';\n"],"mappings":"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"}