import _defineProperty from"@babel/runtime/helpers/defineProperty";import _slicedToArray from"@babel/runtime/helpers/slicedToArray";import _objectWithoutProperties from"@babel/runtime/helpers/objectWithoutProperties";var _excluded=["valueAtom","inputMinWidthAtom"],_excluded2=["children","className","inputMinWidthAtom","size","style"],_excluded3=["className","inputRef","inputMaxLength","inputMinLength","value","inputValue","inputDefaultValue","renderValue","onFocus","onBlur","autoFocus","inputTabIndex","inputAriaLabel","disabled","size","placeholder","onKeyDown","onKeyDownCapture","onChange","onKeyUp","onKeyUpCapture","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onWheel","disableInput"];function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(Object(b),!0).forEach(function(c){_defineProperty(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(Object(b)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}import{useAction,useAtom,useUpdate}from"@reatom/npm-react";import React,{forwardRef,useRef}from"react";import{useComponentSize}from"../../../hooks/useComponentSize";import{useForkRef}from"../../../hooks/useForkRef";import{usePropAtom,useSendToAtom,withCtx}from"../../../utils/state";import{useCreateAtom}from"../../../utils/state/useCreateAtom";import{cnFieldArrayValueInlineControl}from"./cnFieldArrayValueInlineControl";var gapMap={l:"calc(var(--space-3xs) + var(--space-2xs))",m:"var(--space-2xs)",s:"var(--space-3xs)",xs:"var(--space-3xs)"},verticalPaddingMap={l:"var(--space-xs)",m:"calc(var(--space-xs) - var(--space-3xs))",s:"var(--space-2xs)",xs:"var(--space-3xs)"},inputHeightMap={l:"var(--space-2xl)",m:"calc(var(--space-2xl) - var(--space-2xs))",s:"var(--space-xl)",xs:"var(--space-l)"},InputFakeElement=forwardRef(function(a,b){var c=a.valueAtom,d=a.inputMinWidthAtom,e=_objectWithoutProperties(a,_excluded),f=useAtom(c),g=_slicedToArray(f,1),h=g[0],i=useRef(null),j=useComponentSize(i),k=j.width;return useUpdate(function(a,b){d(a,b)},[k]),React.createElement("div",Object.assign({},e,{ref:useForkRef([b,i])}),h)}),Root=forwardRef(function(a,b){var c,d=a.children,e=a.className,f=a.inputMinWidthAtom,g=a.size,h=void 0===g?"m":g,i=a.style,j=_objectWithoutProperties(a,_excluded2),k=useAtom(f),l=_slicedToArray(k,1),m=l[0];return React.createElement("div",Object.assign({},j,{className:cnFieldArrayValueInlineControl(null,[e]),ref:b,style:_objectSpread(_objectSpread({},i),{},(c={},_defineProperty(c,"--field-array-value-inline-control-items-gap",gapMap[h]),_defineProperty(c,"--field-array-value-inline-control-input-min-width","".concat(m,"px")),_defineProperty(c,"--field-array-value-inline-control-vertical-padding","".concat(verticalPaddingMap[h])),_defineProperty(c,"--field-array-value-inline-control-input-height","".concat(inputHeightMap[h])),c))}),d)}),FieldArrayValueInlineControlRender=function(a,b){var c=a.className,d=a.inputRef,e=a.inputMaxLength,f=a.inputMinLength,g=a.value,h=void 0===g?[]:g,i=a.inputValue,j=a.inputDefaultValue,k=void 0===j?"":j,l=a.renderValue,m=a.onFocus,n=a.onBlur,o=a.autoFocus,p=a.inputTabIndex,q=a.inputAriaLabel,r=a.disabled,s=a.size,t=void 0===s?"m":s,u=a.placeholder,v=a.onKeyDown,w=a.onKeyDownCapture,x=a.onChange,y=a.onKeyUp,z=a.onKeyUpCapture,A=a.onCopy,B=a.onCopyCapture,C=a.onCut,D=a.onCutCapture,E=a.onPaste,F=a.onPasteCapture,G=a.onWheel,H=a.disableInput,I=_objectWithoutProperties(a,_excluded3),J=useSendToAtom(a),K=usePropAtom(J,"inputValue"),L=useCreateAtom(i||k),M=useCreateAtom(k),N=useCreateAtom(0),O=useRef(null),P=useRef(null),Q=useAction(function(a,b){L(a,b.target.value);var c=a.get(J),d=c.onChange;d&&d(b)},[]);return useAtom(function(a){var b=a.spy(K),c=a.get(M);c?M(a,""):(P.current&&(P.current.value=b||""),L(a,b))}),React.createElement(Root,Object.assign({},I,{className:cnFieldArrayValueInlineControl(null,[c]),ref:b,size:t,inputMinWidthAtom:N}),l(h||[]),React.createElement("input",{className:cnFieldArrayValueInlineControl("Input",{disabled:H}),onChange:Q,ref:useForkRef([P,d]),maxLength:e,onFocus:m,onBlur:n,autoFocus:o,tabIndex:p,"aria-label":q,onKeyDown:v,onKeyDownCapture:w,onKeyUp:y,onKeyUpCapture:z,disabled:r,type:"text",placeholder:h.length?void 0:u,onCopy:A,onCopyCapture:B,onCut:C,onCutCapture:D,onPaste:E,onPasteCapture:F,onWheel:G,defaultValue:k,readOnly:H}),React.createElement(InputFakeElement,{ref:O,className:cnFieldArrayValueInlineControl("HelperInputFakeElement"),valueAtom:L,inputMinWidthAtom:N}))};export var FieldArrayValueInlineControl=withCtx(forwardRef(FieldArrayValueInlineControlRender));
//# sourceMappingURL=FieldArrayValueInlineControl.js.map