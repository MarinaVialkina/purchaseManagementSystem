{"version":3,"file":"TextFieldTypeNumber.js","names":["React","forwardRef","useCallback","useMemo","FieldClearButton","FieldControlLayout","FieldCounter","FieldInput","renderSide","useForkRef","useKeys","useMutableRef","useSortSteps","useTextField","cnTextFieldTypeNumber","getValueByStep","stepIsActive","TextFieldTypeNumber","props","componentRef","className","value","defaultValue","onChange","id","name","inputRefProp","inputRef","maxLength","minLength","disabled","size","view","form","status","onBlur","onFocus","autoFocus","placeholder","leftSide","rightSide","autoComplete","clearButton","readOnly","type","tabIndex","ariaLabel","iconSize","onClick","incrementButtons","max","min","step","onKeyDown","onKeyDownCapture","onKeyUp","onKeyUpCapture","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onClear","onWheel","iconClear","otherProps","handleBlur","handleChange","handleClear","handleFocus","focused","withValue","ref","handleClick","mutableRefs","setWithValue","sortSteps","refs","changeNumberValue","e","isIncrement","current","newValue","on","handleIncrementButton","handleDecrementButton","handleInputKeyDown","isActive","keys","ArrowUp","preventDefault","ArrowDown","onEvent","handleWheel","blur"],"sources":["../../../../../../src/components/TextFieldCanary/TextFieldTypeNumber/TextFieldTypeNumber.tsx"],"sourcesContent":["import React, { forwardRef, useCallback, useMemo } from 'react';\n\nimport {\n  FieldClearButton,\n  FieldControlLayout,\n  FieldCounter,\n  FieldInput,\n  renderSide,\n} from '##/components/FieldComponents';\nimport { useForkRef } from '##/hooks/useForkRef';\nimport { useKeys } from '##/hooks/useKeys';\nimport { useMutableRef } from '##/hooks/useMutableRef/useMutableRef';\nimport { useSortSteps } from '##/hooks/useSortSteps';\n\nimport { TextFieldTypeComponent } from '../types';\nimport { useTextField } from '../useTextField';\nimport { cnTextFieldTypeNumber } from './cnTextFieldTypeNumber';\nimport { getValueByStep, stepIsActive } from './helpers';\n\nexport const TextFieldTypeNumber: TextFieldTypeComponent<'number'> = forwardRef(\n  (props, componentRef) => {\n    const {\n      className,\n      value,\n      defaultValue,\n      onChange,\n      id,\n      name,\n      inputRef: inputRefProp,\n      maxLength,\n      minLength,\n      disabled,\n      size = 'm',\n      view = 'default',\n      form,\n      status,\n      onBlur,\n      onFocus,\n      autoFocus,\n      placeholder,\n      leftSide,\n      rightSide,\n      autoComplete,\n      clearButton,\n      readOnly,\n      type,\n      tabIndex,\n      ariaLabel,\n      iconSize,\n      onClick,\n      incrementButtons,\n      max,\n      min,\n      step,\n      // onKey props\n      onKeyDown,\n      onKeyDownCapture,\n      onKeyUp,\n      onKeyUpCapture,\n      onCopy,\n      onCopyCapture,\n      onCut,\n      onCutCapture,\n      onPaste,\n      onPasteCapture,\n      onClear,\n      onWheel,\n      iconClear,\n      ...otherProps\n    } = props;\n\n    const {\n      handleBlur,\n      handleChange,\n      handleClear,\n      handleFocus,\n      focused,\n      withValue,\n      ref,\n      inputRef,\n      handleClick,\n      mutableRefs,\n      setWithValue,\n    } = useTextField({\n      onClick,\n      onChange,\n      onBlur,\n      onFocus,\n      disabled,\n      onClear,\n    });\n\n    const sortSteps = useSortSteps({ step, min, max });\n\n    const refs = useMutableRef([\n      sortSteps,\n      min,\n      max,\n      onKeyDown,\n      stepIsActive(sortSteps, disabled),\n      onWheel,\n    ] as const);\n\n    const changeNumberValue = useCallback(\n      <T extends React.MouseEvent<HTMLButtonElement> | React.KeyboardEvent>(\n        e: T,\n        isIncrement: boolean,\n      ) => {\n        if (!inputRef.current || mutableRefs.current[4]) {\n          return;\n        }\n\n        const newValue = getValueByStep(\n          refs.current[0],\n          inputRef.current.value,\n          isIncrement,\n          refs.current[1],\n          refs.current[2],\n        );\n\n        mutableRefs.current[0]?.(newValue, { e });\n\n        inputRef.current.value = newValue;\n        setWithValue.on();\n      },\n      [],\n    );\n\n    const handleIncrementButton = useCallback(\n      (e: React.MouseEvent<HTMLButtonElement>) => changeNumberValue(e, true),\n      [],\n    );\n\n    const handleDecrementButton = useCallback(\n      (e: React.MouseEvent<HTMLButtonElement>) => changeNumberValue(e, false),\n      [],\n    );\n\n    const handleInputKeyDown = useKeys<Element>(\n      useMemo(\n        () => ({\n          isActive: true,\n          keys: {\n            ArrowUp: (e) => {\n              e.preventDefault();\n              refs.current[4] && changeNumberValue(e, true);\n            },\n            ArrowDown: (e) => {\n              e.preventDefault();\n              refs.current[4] && changeNumberValue(e, false);\n            },\n          },\n          onEvent: refs.current[3],\n        }),\n        [],\n      ),\n    );\n\n    const handleWheel = useCallback((e: React.WheelEvent<HTMLInputElement>) => {\n      if (refs.current[5]) {\n        refs.current[5](e);\n      } else {\n        inputRef.current?.blur();\n      }\n    }, []);\n\n    return (\n      <FieldControlLayout\n        {...otherProps}\n        className={cnTextFieldTypeNumber({ incrementButtons }, [className])}\n        form={form}\n        status={status}\n        size={size}\n        leftSide={renderSide(leftSide, size, iconSize)}\n        rightSide={[\n          clearButton && !disabled && withValue && !incrementButtons && (\n            <FieldClearButton\n              size={size}\n              onClick={handleClear}\n              icon={iconClear}\n            />\n          ),\n          incrementButtons && refs.current[4] && (\n            <FieldCounter\n              onIncrementClick={handleIncrementButton}\n              onIncrementFocus={handleFocus}\n              onDecrementClick={handleDecrementButton}\n              onDecrementFocus={handleFocus}\n            />\n          ),\n        ]}\n        focused={focused}\n        view={view}\n        ref={useForkRef([componentRef, ref])}\n        disabled={disabled}\n        onClick={handleClick}\n      >\n        <FieldInput\n          className={cnTextFieldTypeNumber('Input')}\n          placeholder={placeholder}\n          autoFocus={autoFocus}\n          autoComplete={autoComplete}\n          onBlur={handleBlur}\n          onChange={handleChange}\n          onFocus={handleFocus}\n          defaultValue={defaultValue || undefined}\n          value={value === null ? '' : value}\n          ref={useForkRef([inputRefProp, inputRef])}\n          readOnly={readOnly}\n          tabIndex={tabIndex}\n          aria-label={ariaLabel}\n          onKeyDown={handleInputKeyDown}\n          onKeyDownCapture={onKeyDownCapture}\n          onKeyUp={onKeyUp}\n          onKeyUpCapture={onKeyUpCapture}\n          onWheel={handleWheel}\n          maxLength={maxLength}\n          minLength={minLength}\n          disabled={disabled}\n          type={type}\n          max={max}\n          min={min}\n          id={id}\n          name={name}\n          onCopy={onCopy}\n          onCopyCapture={onCopyCapture}\n          onCut={onCut}\n          onCutCapture={onCutCapture}\n          onPaste={onPaste}\n          onPasteCapture={onPasteCapture}\n        />\n      </FieldControlLayout>\n    );\n  },\n);\n"],"mappings":"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"}