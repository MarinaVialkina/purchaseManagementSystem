{"version":3,"file":"StepsCanary.js","names":["IconArrowLeft","React","forwardRef","useCallback","useEffect","useRef","Button","useChoiceGroup","useMutableRef","useOverflow","useScrollElements","cnMixScrollBar","cnCanary","withDefaultGetters","StepsStep","cnSteps","StepsRender","props","ref","size","items","value","getItemLabel","getItemDisabled","getItemIcon","getItemStatus","getItemDescription","onChange","className","style","withNumber","labelWordWrap","fitMode","otherProps","listRef","refs","scrollTo","getKey","callBack","multiple","getOnChange","getChecked","activeStep","findIndex","mutableRefs","isOverflow","currentRef","toPrevStep","e","current","currentStep","getDisabled","nextStep","toNextStep","prevStep","length","position","invisible","map","item","index","Steps"],"sources":["../../../../../src/components/StepsCanary/StepsCanary.tsx"],"sourcesContent":["import './Steps.css';\n\nimport { IconArrowLeft } from '@consta/icons/IconArrowLeft';\nimport React, { forwardRef, useCallback, useEffect, useRef } from 'react';\n\nimport { Button } from '##/components/Button';\nimport { useChoiceGroup } from '##/hooks/useChoiceGroup/useChoiceGroup';\nimport { useMutableRef } from '##/hooks/useMutableRef';\nimport { useOverflow } from '##/hooks/useOverflow/useOverflow';\nimport { useScrollElements } from '##/hooks/useScrollElements/useScrollElements';\nimport { cnMixScrollBar } from '##/mixs/MixScrollBar';\nimport { cnCanary } from '##/utils/bem';\n\nimport { withDefaultGetters } from './helper';\nimport { StepsStep } from './StepsItem';\nimport { StepsComponent, StepsProps } from './types';\n\nexport const cnSteps = cnCanary('Steps');\n\nconst StepsRender = (props: StepsProps, ref: React.Ref<HTMLDivElement>) => {\n  const {\n    size = 'm',\n    items,\n    value,\n    getItemLabel,\n    getItemDisabled,\n    getItemIcon,\n    getItemStatus,\n    getItemDescription,\n    onChange,\n    className,\n    style,\n    withNumber,\n    labelWordWrap,\n    fitMode = 'scroll',\n    ...otherProps\n  } = withDefaultGetters(props);\n\n  const listRef = useRef<HTMLDivElement>(null);\n  const { refs, scrollTo } = useScrollElements(items, listRef);\n\n  const { getOnChange, getChecked } = useChoiceGroup({\n    value,\n    getKey: getItemLabel,\n    callBack: onChange,\n    multiple: false,\n  });\n\n  const activeStep = items.findIndex(getChecked);\n\n  const mutableRefs = useMutableRef([\n    activeStep,\n    getOnChange,\n    getItemDisabled,\n  ] as const);\n\n  const isOverflow =\n    useOverflow({ currentRef: listRef }) && fitMode === 'scrollWithButtons';\n\n  const toPrevStep = useCallback((e: React.MouseEvent) => {\n    const [currentStep, getOnChange, getDisabled] = mutableRefs.current;\n    const nextStep = currentStep - 1;\n\n    if (nextStep >= 0) {\n      !getDisabled(items[nextStep]) && getOnChange?.(items[nextStep])(e);\n    }\n  }, []);\n\n  const toNextStep = useCallback((e: React.MouseEvent) => {\n    const [currentStep, getOnChange, getDisabled] = mutableRefs.current;\n    const prevStep = currentStep + 1;\n\n    if (prevStep <= items.length - 1) {\n      !getDisabled(items[prevStep]) && getOnChange?.(items[prevStep])(e);\n    }\n  }, []);\n\n  useEffect(() => {\n    scrollTo(activeStep);\n  }, [activeStep]);\n\n  return (\n    <div\n      {...otherProps}\n      ref={ref}\n      className={cnSteps({ size }, [className])}\n      style={{\n        ...style,\n        ['--steps-items-length' as string]: items.length,\n      }}\n    >\n      {isOverflow && (\n        <Button\n          className={cnSteps('ScrollButton', { position: 'left' })}\n          iconLeft={IconArrowLeft}\n          view=\"clear\"\n          onlyIcon\n          size=\"xs\"\n          type=\"button\"\n          onClick={toPrevStep}\n        />\n      )}\n      <div\n        ref={listRef}\n        className={cnSteps('List', [cnMixScrollBar({ invisible: true })])}\n      >\n        {items.map((item, index) => (\n          <StepsStep\n            key={index}\n            ref={refs[index] as React.RefObject<HTMLButtonElement>}\n            className={cnSteps('Item')}\n            label={getItemLabel(item)}\n            number={index + 1}\n            withNumber={withNumber}\n            size={size}\n            active={activeStep === index}\n            onChange={getOnChange(item)}\n            disabled={getItemDisabled(item)}\n            status={getItemStatus(item)}\n            description={getItemDescription(item)}\n            labelWordWrap={labelWordWrap}\n            icon={getItemIcon(item)}\n          />\n        ))}\n      </div>\n      {isOverflow && (\n        <Button\n          className={cnSteps('ScrollButton', { position: 'right' })}\n          iconLeft={IconArrowLeft}\n          view=\"clear\"\n          onlyIcon\n          size=\"xs\"\n          type=\"button\"\n          onClick={toNextStep}\n        />\n      )}\n    </div>\n  );\n};\n\nexport const Steps = forwardRef(StepsRender) as StepsComponent;\n\nexport * from './types';\n"],"mappings":"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"}