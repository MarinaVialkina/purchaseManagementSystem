{"version":3,"file":"FlatSelectCreateButton.js","names":["useAtom","React","forwardRef","ListAddItem","cn","cnFlatSelectCreateButton","labelForCreateDefault","label","FlatSelectCreateButton","props","ref","className","labelForCreate","inputValueAtom","index","size","highlightedIndexAtom","disabledAtom","otherProps","ctx","highlightedIndex","spy","disabled","active","inputValue"],"sources":["../../../../../../src/components/FlatSelect/FlatSelectCreateButton/FlatSelectCreateButton.tsx"],"sourcesContent":["import './FlatSelectCreateButton.css';\n\nimport { AtomMut } from '@reatom/framework';\nimport { useAtom } from '@reatom/npm-react';\nimport React, { forwardRef } from 'react';\n\nimport { FieldPropSize } from '##/components/FieldComponents';\nimport { ListAddItem } from '##/components/ListCanary';\nimport { cn } from '##/utils/bem';\nimport { PropsWithHTMLAttributesAndRef } from '##/utils/types/PropsWithHTMLAttributes';\n\ntype LabelForCreate =\n  | ((label: string | undefined) => React.ReactNode)\n  | React.ReactNode;\n\ntype FlatSelectCreateButtonProps = PropsWithHTMLAttributesAndRef<\n  {\n    labelForCreate?: LabelForCreate;\n    inputValueAtom: AtomMut<string>;\n    size: FieldPropSize;\n    indent: 'normal' | 'increased';\n    index: number;\n    highlightedIndexAtom: AtomMut<number>;\n    disabledAtom: AtomMut<boolean>;\n  },\n  HTMLDivElement\n>;\n\nexport const cnFlatSelectCreateButton = cn('FlatSelectCreateButton');\n\nconst labelForCreateDefault: LabelForCreate = (label) => (\n  <span className={cnFlatSelectCreateButton('CreateLabel')}>\n    {label ? (\n      <>\n        Добавить <b>«{label}»</b>\n      </>\n    ) : (\n      'Добавить элемент'\n    )}\n  </span>\n);\n\ntype FlatSelectCreateButtonComponent = (\n  props: FlatSelectCreateButtonProps,\n) => React.ReactNode | null;\n\nexport const FlatSelectCreateButton: FlatSelectCreateButtonComponent =\n  forwardRef((props, ref) => {\n    const {\n      className,\n      labelForCreate = labelForCreateDefault,\n      inputValueAtom,\n      index,\n      size,\n\n      highlightedIndexAtom,\n      disabledAtom,\n      ...otherProps\n    } = props;\n\n    const [active] = useAtom((ctx) => {\n      const highlightedIndex = ctx.spy(highlightedIndexAtom);\n      const disabled = ctx.spy(disabledAtom);\n      if (disabled) {\n        return false;\n      }\n      return index === highlightedIndex;\n    });\n\n    const [inputValue] = useAtom(inputValueAtom);\n    const [disabled] = useAtom(disabledAtom);\n\n    return (\n      <ListAddItem\n        {...otherProps}\n        ref={ref}\n        className={cnFlatSelectCreateButton(null, [className])}\n        role=\"option\"\n        active={active}\n        size={size}\n        disabled={disabled}\n        label={\n          typeof labelForCreate === 'function'\n            ? labelForCreate(inputValue)\n            : labelForCreate\n        }\n        underLine\n      />\n    );\n  });\n"],"mappings":"yQAAA,qCAGA,OAASA,OAAT,KAAwB,mBAAxB,CACA,MAAOC,MAAP,EAAgBC,UAAhB,KAAkC,OAAlC,CAGA,OAASC,WAAT,wBACA,OAASC,EAAT,0BAoBA,MAAO,IAAMC,yBAAwB,CAAGD,EAAE,CAAC,wBAAD,CAAnC,CAEP,GAAME,sBAAqC,CAAG,SAACC,CAAD,QAC5C,6BAAM,SAAS,CAAEF,wBAAwB,CAAC,aAAD,CAAzC,EACGE,CAAK,CACJ,4FACW,oCAAKA,CAAL,QADX,CADI,CAKJ,6FANJ,CAD4C,CAA9C,CAgBA,MAAO,IAAMC,uBAAuD,CAClEN,UAAU,CAAC,SAACO,CAAD,CAAQC,CAAR,CAAgB,IAEvBC,EAFuB,CAWrBF,CAXqB,CAEvBE,SAFuB,GAWrBF,CAXqB,CAGvBG,cAHuB,CAGvBA,CAHuB,YAGNN,qBAHM,GAIvBO,CAJuB,CAWrBJ,CAXqB,CAIvBI,cAJuB,CAKvBC,CALuB,CAWrBL,CAXqB,CAKvBK,KALuB,CAMvBC,CANuB,CAWrBN,CAXqB,CAMvBM,IANuB,CAQvBC,CARuB,CAWrBP,CAXqB,CAQvBO,oBARuB,CASvBC,CATuB,CAWrBR,CAXqB,CASvBQ,YATuB,CAUpBC,CAVoB,0BAWrBT,CAXqB,cAaRT,OAAO,CAAC,SAACmB,CAAD,CAAS,IAC1BC,EAAgB,CAAGD,CAAG,CAACE,GAAJ,CAAQL,CAAR,CADO,CAE1BM,CAAQ,CAAGH,CAAG,CAACE,GAAJ,CAAQJ,CAAR,CAFe,QAG5BK,CAH4B,EAMzBR,CAAK,GAAKM,CAClB,CAPuB,CAbC,uBAalBG,CAbkB,QAsBJvB,OAAO,CAACa,CAAD,CAtBH,uBAsBlBW,CAtBkB,QAuBNxB,OAAO,CAACiB,CAAD,CAvBD,uBAuBlBK,CAvBkB,MAyBzB,MACE,qBAAC,WAAD,kBACMJ,CADN,EAEE,GAAG,CAAER,CAFP,CAGE,SAAS,CAAEL,wBAAwB,CAAC,IAAD,CAAO,CAACM,CAAD,CAAP,CAHrC,CAIE,IAAI,CAAC,QAJP,CAKE,MAAM,CAAEY,CALV,CAME,IAAI,CAAER,CANR,CAOE,QAAQ,CAAEO,CAPZ,CAQE,KAAK,CACuB,UAA1B,QAAOV,EAAP,CACIA,CAAc,CAACY,CAAD,CADlB,CAEIZ,CAXR,CAaE,SAAS,GAbX,GAgBH,CA1CS,CADL"}