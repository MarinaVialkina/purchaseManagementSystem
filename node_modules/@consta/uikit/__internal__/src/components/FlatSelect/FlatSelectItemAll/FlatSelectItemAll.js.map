{"version":3,"file":"FlatSelectItemAll.js","names":["useAtom","React","forwardRef","Checkbox","ListItem","Text","cn","sizeCheckboxMap","cnFlatSelectItemAll","textSizeMap","xs","s","m","l","FlatSelectItemAllCounter","groupsCounterAtom","groupId","size","ctx","counter","spy","total","selected","FlatSelectItemAllCounterCheckbox","disabledAtom","checked","intermediate","disabled","FlatSelectItemAll","props","ref","className","highlightedIndexAtom","index","label","otherProps","hovered"],"sources":["../../../../../../src/components/FlatSelect/FlatSelectItemAll/FlatSelectItemAll.tsx"],"sourcesContent":["import { AtomMut } from '@reatom/framework';\nimport { useAtom } from '@reatom/npm-react';\nimport React, { forwardRef } from 'react';\n\nimport { Checkbox } from '##/components/Checkbox';\nimport { FieldPropSize } from '##/components/FieldComponents';\nimport { ListItem } from '##/components/ListCanary';\nimport { Text, TextPropSize } from '##/components/Text';\nimport { cn } from '##/utils/bem';\nimport { PropsWithHTMLAttributesAndRef } from '##/utils/types/PropsWithHTMLAttributes';\n\nimport { sizeCheckboxMap } from '../FlatSelectItem';\n\nexport type FlatFlatSelectItemAllProps = PropsWithHTMLAttributesAndRef<\n  {\n    size: FieldPropSize;\n    hovered?: boolean;\n    indent?: 'normal' | 'increased';\n    groupsCounterAtom: AtomMut<Record<string, [number, number]>>;\n    groupId: string | number;\n    highlightedIndexAtom: AtomMut<number>;\n    index: number;\n    label: string;\n    disabledAtom: AtomMut<boolean>;\n  },\n  HTMLDivElement\n>;\n\nexport const cnFlatSelectItemAll = cn('FlatSelectItemAll');\n\nconst textSizeMap: Record<FieldPropSize, TextPropSize> = {\n  xs: 's',\n  s: 's',\n  m: 'm',\n  l: 'l',\n};\n\nconst FlatSelectItemAllCounter: React.FC<{\n  groupsCounterAtom: AtomMut<Record<string, [number, number]>>;\n  groupId: string | number;\n  size: FieldPropSize;\n}> = ({ groupsCounterAtom, groupId, size }) => {\n  const [total] = useAtom((ctx) => {\n    const counter = ctx.spy(groupsCounterAtom);\n    return counter[groupId]?.[1] || 0;\n  });\n  const [selected] = useAtom((ctx) => {\n    const counter = ctx.spy(groupsCounterAtom);\n    return counter[groupId]?.[0] || 0;\n  });\n\n  return (\n    <Text\n      size={textSizeMap[size]}\n      lineHeight=\"xs\"\n      view=\"ghost\"\n    >{`${selected} из ${total}`}</Text>\n  );\n};\n\nconst FlatSelectItemAllCounterCheckbox: React.FC<{\n  groupsCounterAtom: AtomMut<Record<string, [number, number]>>;\n  disabledAtom: AtomMut<boolean>;\n  groupId: string | number;\n  size: FieldPropSize;\n}> = ({ groupsCounterAtom, groupId, size, disabledAtom }) => {\n  const [checked] = useAtom((ctx) => {\n    const counter = ctx.spy(groupsCounterAtom);\n    if (counter[groupId] === undefined) {\n      return false;\n    }\n    return counter[groupId][0] === counter[groupId][1];\n  });\n  const [intermediate] = useAtom((ctx) => {\n    const counter = ctx.spy(groupsCounterAtom);\n    if (counter[groupId] === undefined) {\n      return false;\n    }\n    return counter[groupId][0] > 0 && counter[groupId][0] < counter[groupId][1];\n  });\n  const [disabled] = useAtom(disabledAtom);\n\n  return (\n    <Checkbox\n      checked={checked}\n      intermediate={intermediate}\n      size={sizeCheckboxMap[size]}\n      tabIndex={-1}\n      disabled={disabled}\n    />\n  );\n};\n\nexport const FlatSelectItemAll: React.FC<FlatFlatSelectItemAllProps> =\n  forwardRef((props, ref) => {\n    const {\n      size,\n      className,\n      groupsCounterAtom,\n      groupId,\n      highlightedIndexAtom,\n      disabledAtom,\n      index,\n      label,\n      ...otherProps\n    } = props;\n\n    const [hovered] = useAtom((ctx) => ctx.spy(highlightedIndexAtom) === index);\n    const [disabled] = useAtom(disabledAtom);\n\n    return (\n      <ListItem\n        {...otherProps}\n        ref={ref}\n        className={cnFlatSelectItemAll(null, [className])}\n        role=\"option\"\n        label={label}\n        size={size}\n        active={hovered}\n        disabled={disabled}\n        rightSide={\n          <FlatSelectItemAllCounter\n            size={size}\n            groupsCounterAtom={groupsCounterAtom}\n            groupId={groupId}\n          />\n        }\n        leftSide={\n          <FlatSelectItemAllCounterCheckbox\n            size={size}\n            groupsCounterAtom={groupsCounterAtom}\n            groupId={groupId}\n            disabledAtom={disabledAtom}\n          />\n        }\n      />\n    );\n  });\n"],"mappings":"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"}