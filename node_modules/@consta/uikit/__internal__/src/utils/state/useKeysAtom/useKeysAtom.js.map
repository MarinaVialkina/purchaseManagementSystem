{"version":3,"file":"useKeysAtom.js","names":["useAction","useElementAtomEventListener","useSendToAtom","useKeysAtom","elAtom","keysAtom","isActiveAtom","eventType","eventHandler","eventHandlerAtom","fn","ctx","e","keys","get","isActive","code","key"],"sources":["../../../../../../src/utils/state/useKeysAtom/useKeysAtom.ts"],"sourcesContent":["import { AtomMut } from '@reatom/core';\nimport { useAction } from '@reatom/npm-react';\n\nimport { useElementAtomEventListener } from '##/utils/state/useElementAtomEventListener';\nimport { useSendToAtom } from '##/utils/state/useSendToAtom';\nimport { KeyCode } from '##/utils/types/KeyCode';\n\nexport type KeyHandlers = Partial<\n  Record<KeyCode, (e: KeyboardEvent) => void>\n> & {\n  [key: string]: (e: KeyboardEvent) => void;\n};\n\ntype UseKeysProps<E extends HTMLElement> = {\n  elAtom: AtomMut<E | null>;\n  keysAtom?: AtomMut<KeyHandlers>;\n  isActiveAtom?: AtomMut<boolean>;\n  eventHandler?: (e: KeyboardEvent) => void;\n  eventType?: 'keypress' | 'keydown' | 'keyup';\n};\n\nexport const useKeysAtom = <E extends HTMLElement>({\n  elAtom,\n  keysAtom,\n  isActiveAtom,\n  eventType = 'keydown',\n  eventHandler,\n}: UseKeysProps<E>) => {\n  const eventHandlerAtom = useSendToAtom([eventHandler]);\n  const fn = useAction((ctx, e: KeyboardEvent) => {\n    const keys = keysAtom && ctx.get(keysAtom);\n    const isActive = isActiveAtom && ctx.get(isActiveAtom);\n    if (keys && isActive) {\n      (keys[e.code as KeyCode] || keys[e.key as KeyCode])?.(e);\n    }\n    ctx.get(eventHandlerAtom)[0]?.(e);\n  });\n\n  useElementAtomEventListener(elAtom, eventType, fn as EventListener);\n};\n"],"mappings":"AACA,OAASA,SAAT,KAA0B,mBAA1B,CAEA,OAASC,2BAAT,sCACA,OAASC,aAAT,wBAiBA,MAAO,IAAMC,YAAW,CAAG,WAMJ,IALrBC,EAKqB,GALrBA,MAKqB,CAJrBC,CAIqB,GAJrBA,QAIqB,CAHrBC,CAGqB,GAHrBA,YAGqB,KAFrBC,SAEqB,CAFrBA,CAEqB,YAFT,SAES,GADrBC,CACqB,GADrBA,YACqB,CACfC,CAAgB,CAAGP,aAAa,CAAC,CAACM,CAAD,CAAD,CADjB,CAEfE,CAAE,CAAGV,SAAS,CAAC,SAACW,CAAD,CAAMC,CAAN,CAA2B,SACxCC,CAAI,CAAGR,CAAQ,EAAIM,CAAG,CAACG,GAAJ,CAAQT,CAAR,CADqB,CAExCU,CAAQ,CAAGT,CAAY,EAAIK,CAAG,CAACG,GAAJ,CAAQR,CAAR,CAFa,CAG9C,GAAIO,CAAI,EAAIE,CAAZ,CAAsB,iBACnBF,CAAI,CAACD,CAAC,CAACI,IAAH,CAAJ,EAA2BH,CAAI,CAACD,CAAC,CAACK,GAAH,CADZ,qBACpB,EAAsDL,CAAtD,CACD,CAL6C,UAM9C,GAAAD,CAAG,CAACG,GAAJ,CAAQL,CAAR,GAA0B,CAA1B,CAN8C,qBAM9C,SAA+BG,CAA/B,CACD,CAPmB,CAFC,CAWrBX,2BAA2B,CAACG,CAAD,CAASG,CAAT,CAAoBG,CAApB,CAC5B,CAlBM"}