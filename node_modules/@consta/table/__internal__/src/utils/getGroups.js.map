{"version":3,"file":"getGroups.js","names":["defaultGroupKey","getItemGroupKeyGuard","getter","item","noGroupKey","key","getGroups","items","getItemGroupKey","groups","getGroupKey","sortGroups","groupIndex","resultGroups","itemGroupKey","resultGroupIndex","findIndex","group","push","g","resultGroup","undefined","sort","a","b","getCountedGroups","values","selectAll","getItemKey","getItemDisabled","copyGroups","forEach","index","totalCount","checkedCount","find","el","__optionSelctAll","groupKey"],"sources":["../../../../src/utils/getGroups.ts"],"sourcesContent":["export type Group<ITEM, GROUP> = {\n  items: ITEM[];\n  key: string | number;\n  group?: GROUP;\n  groupIndex: number;\n};\n\nexport type SelectAllItem = {\n  checkedCount: number;\n  totalCount: number;\n  groupKey: string | number;\n  __optionSelctAll: true;\n};\n\nexport type CountedGroup<ITEM, GROUP> = Omit<Group<ITEM, GROUP>, 'items'> & {\n  items: Array<SelectAllItem | ITEM>;\n};\n\ntype GetItemGroupKey<ITEM> = (item: ITEM) => string | number | undefined;\ntype GetItemKey<ITEM> = (item: ITEM) => string | number | undefined;\ntype GetItemDisabled<ITEM> = (item: ITEM) => boolean | undefined;\ntype GetGroupKey<GROUP> = (item: GROUP) => string | number | undefined;\ntype SortGroups<ITEM, GROUP> = (\n  a: Group<ITEM, GROUP>,\n  b: Group<ITEM, GROUP>,\n) => number;\ntype GetGroupsResult<ITEM, GROUP> = Group<ITEM, GROUP>[];\n\nexport const defaultGroupKey = 'no-group';\n\nconst getItemGroupKeyGuard = <ITEM>(\n  getter: GetGroupKey<ITEM>,\n  item: ITEM,\n  noGroupKey: string,\n) => {\n  const key = getter(item);\n\n  return typeof key === 'undefined' ? noGroupKey : key;\n};\n\n/**\n * @param items список который нужно групировать\n * @param getItemGroupKey признак принадлежности к группе\n * @param groups список групп\n * @param getGroupKey результат функции должен вернуть уникальный ключ группы\n * @param sortGroups сортировка групп\n * @param noGroupKey ключ группы которая создаться если item небудет принадлежать ни к одной из групп\n */\n\nexport function getGroups<ITEM, GROUP>(\n  items: ITEM[],\n  getItemGroupKey: GetItemGroupKey<ITEM> | undefined,\n  groups: GROUP[] | undefined,\n  getGroupKey: GetGroupKey<GROUP> | undefined,\n  sortGroups: SortGroups<ITEM, GROUP> | undefined,\n  noGroupKey = defaultGroupKey,\n): GetGroupsResult<ITEM, GROUP> {\n  if (typeof getItemGroupKey !== 'function') {\n    return [{ items, key: noGroupKey, groupIndex: -1 }];\n  }\n\n  const resultGroups: GetGroupsResult<ITEM, GROUP> = [];\n  for (const item of items) {\n    const itemGroupKey = getItemGroupKeyGuard(\n      getItemGroupKey,\n      item,\n      noGroupKey,\n    );\n    const resultGroupIndex = resultGroups.findIndex(\n      (group) => group.key === itemGroupKey,\n    );\n\n    if (resultGroupIndex >= 0) {\n      resultGroups[resultGroupIndex].items.push(item);\n    } else {\n      const groupIndex =\n        getGroupKey && groups\n          ? groups.findIndex((g) => getGroupKey(g) === itemGroupKey)\n          : -1;\n\n      const resultGroup: Group<ITEM, GROUP> = {\n        key: itemGroupKey,\n        items: [item],\n        groupIndex,\n        group: groups ? groups[groupIndex] : undefined,\n      };\n\n      resultGroups.push(resultGroup);\n    }\n  }\n\n  if (typeof sortGroups === 'function') {\n    resultGroups.sort(sortGroups);\n  } else if (groups && getGroupKey) {\n    resultGroups.sort((a, b) => {\n      if (a.groupIndex > b.groupIndex) return 1;\n      if (a.groupIndex < b.groupIndex) return -1;\n      return 0;\n    });\n  }\n\n  return resultGroups;\n}\n\nexport function getCountedGroups<ITEM, GROUP>(\n  groups: GetGroupsResult<ITEM, GROUP>,\n  values: ITEM[] | undefined | null,\n  selectAll: boolean,\n  getItemKey: GetItemKey<ITEM>,\n  getItemDisabled?: GetItemDisabled<ITEM>,\n): CountedGroup<ITEM, GROUP>[] {\n  const copyGroups: CountedGroup<ITEM, GROUP>[] = [...groups];\n  if (selectAll) {\n    groups.forEach((group, index) => {\n      let totalCount = 0;\n      let checkedCount = 0;\n      group.items.forEach((item) => {\n        if (!(getItemDisabled && getItemDisabled?.(item))) {\n          totalCount += 1;\n        }\n        if (values?.find((el) => getItemKey(item) === getItemKey(el))) {\n          checkedCount += 1;\n        }\n      });\n      copyGroups[index].items = [\n        {\n          __optionSelctAll: true,\n          totalCount,\n          groupKey: group.key,\n          checkedCount,\n        },\n        ...copyGroups[index].items,\n      ];\n    });\n  }\n  return copyGroups;\n}\n"],"mappings":"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"}