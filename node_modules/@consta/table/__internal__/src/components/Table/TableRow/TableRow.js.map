{"version":3,"file":"TableRow.js","names":["useAtom","React","forwardRef","cn","TableRowCell","cnTableRow","getMiss","colSpan","index","length","pinned","TableRow","props","ref","className","rowIndex","lowHeadersAtom","zebraStriped","row","tableRef","leftNoVisibleItemsAtom","rightNoVisibleItemsAtom","otherProps","lowHeaders","leftNoVisibleItems","rightNoVisibleItems","miss","nodes","columnIndex","isSeparator","accessor","RenderCell","renderCell","getColSpan","push","key","undefined"],"sources":["../../../../../../src/components/Table/TableRow/TableRow.tsx"],"sourcesContent":["import './TableRow.css';\n\nimport { PropsWithHTMLAttributesAndRef } from '@consta/uikit/__internal__/src/utils/types/PropsWithHTMLAttributes';\nimport { AtomMut } from '@reatom/core';\nimport { useAtom } from '@reatom/npm-react';\nimport React, { forwardRef } from 'react';\n\nimport { cn } from '##/utils/bem';\n\nimport { TableRowCell } from '../TableRowCell';\nimport { TableColumn, TableDefaultRow } from '../types';\n\ntype TableRowProps = PropsWithHTMLAttributesAndRef<\n  {\n    lowHeadersAtom: AtomMut<TableColumn<TableDefaultRow>[]>;\n    zebraStriped: boolean;\n    index: number;\n    row: TableDefaultRow;\n    tableRef: React.RefObject<HTMLDivElement>;\n    leftNoVisibleItemsAtom: AtomMut<number>;\n    rightNoVisibleItemsAtom: AtomMut<number>;\n  },\n  HTMLDivElement\n>;\n\nconst cnTableRow = cn('TableRow');\n\ntype TableRowComponent = (props: TableRowProps) => React.ReactNode | null;\n\nconst getMiss = (\n  colSpan: number | undefined | 'end',\n  index: number,\n  length: number,\n  pinned: boolean,\n) => {\n  if (pinned) {\n    return 0;\n  }\n  if (colSpan === 'end') {\n    return length - index - 1;\n  }\n  if (typeof colSpan === 'number') {\n    return colSpan - 1;\n  }\n  return 0;\n};\n\nexport const TableRow: TableRowComponent = forwardRef((props, ref) => {\n  const {\n    className,\n    index: rowIndex,\n    lowHeadersAtom,\n    zebraStriped,\n    row,\n    tableRef,\n    leftNoVisibleItemsAtom,\n    rightNoVisibleItemsAtom,\n    ...otherProps\n  } = props;\n  const [lowHeaders] = useAtom(lowHeadersAtom);\n  const [leftNoVisibleItems] = useAtom(leftNoVisibleItemsAtom);\n  const [rightNoVisibleItems] = useAtom(rightNoVisibleItemsAtom);\n\n  let miss = 0;\n\n  const nodes: React.ReactNode[] = [];\n\n  for (let columnIndex = 0; columnIndex < lowHeaders.length; columnIndex++) {\n    const {\n      isSeparator,\n      accessor,\n      pinned,\n      renderCell: RenderCell,\n      colSpan: getColSpan,\n    } = lowHeaders[columnIndex];\n\n    if (miss) {\n      miss = miss ? miss - 1 : miss;\n\n      continue;\n    }\n\n    miss = getMiss(\n      getColSpan?.({ row }),\n      columnIndex,\n      lowHeaders.length,\n      !!pinned,\n    );\n\n    if (\n      (!pinned &&\n        columnIndex !== 0 &&\n        leftNoVisibleItems >= 1 &&\n        leftNoVisibleItems - columnIndex - miss >= 1) ||\n      (!pinned &&\n        columnIndex !== 0 &&\n        rightNoVisibleItems >= 0 &&\n        rightNoVisibleItems + columnIndex >= lowHeaders.length)\n    ) {\n      continue;\n    }\n\n    nodes.push(\n      <TableRowCell\n        key={cnTableRow('Cell', { key: accessor || columnIndex })}\n        borderLeft={\n          columnIndex !== 0 &&\n          !(pinned !== 'left' && lowHeaders[columnIndex - 1]?.pinned === 'left')\n        }\n        borderRight={\n          pinned === 'left' && lowHeaders[columnIndex + 1]?.pinned !== 'left'\n        }\n        borderTop={!isSeparator && rowIndex !== 0}\n        ref={columnIndex === 0 ? ref : undefined}\n        row={row}\n        rowIndex={rowIndex}\n        miss={miss}\n        index={columnIndex}\n        tableRef={tableRef}\n        accessor={accessor}\n        separator={isSeparator}\n        pinned={pinned}\n        renderCell={RenderCell}\n      />,\n    );\n  }\n\n  return (\n    <div\n      {...otherProps}\n      className={cnTableRow({ zebraStriped }, [className])}\n      aria-hidden=\"true\"\n    >\n      {nodes}\n    </div>\n  );\n});\n"],"mappings":";;;AAAA;AAIA,SAASA,OAAT,QAAwB,mBAAxB;AACA,OAAOC,KAAP,IAAgBC,UAAhB,QAAkC,OAAlC;AAEA,SAASC,EAAT;AAEA,SAASC,YAAT;AAgBA,IAAMC,UAAU,GAAGF,EAAE,CAAC,UAAD,CAArB;;AAIA,IAAMG,OAAO,GAAG,SAAVA,OAAU,CACdC,OADc,EAEdC,KAFc,EAGdC,MAHc,EAIdC,MAJc,EAKX;EACH,IAAIA,MAAJ,EAAY;IACV,OAAO,CAAP;EACD;;EACD,IAAIH,OAAO,KAAK,KAAhB,EAAuB;IACrB,OAAOE,MAAM,GAAGD,KAAT,GAAiB,CAAxB;EACD;;EACD,IAAI,OAAOD,OAAP,KAAmB,QAAvB,EAAiC;IAC/B,OAAOA,OAAO,GAAG,CAAjB;EACD;;EACD,OAAO,CAAP;AACD,CAhBD;;AAkBA,OAAO,IAAMI,QAA2B,GAAGT,UAAU,CAAC,UAACU,KAAD,EAAQC,GAAR,EAAgB;EACpE,IACEC,SADF,GAUIF,KAVJ,CACEE,SADF;EAAA,IAESC,QAFT,GAUIH,KAVJ,CAEEJ,KAFF;EAAA,IAGEQ,cAHF,GAUIJ,KAVJ,CAGEI,cAHF;EAAA,IAIEC,YAJF,GAUIL,KAVJ,CAIEK,YAJF;EAAA,IAKEC,GALF,GAUIN,KAVJ,CAKEM,GALF;EAAA,IAMEC,QANF,GAUIP,KAVJ,CAMEO,QANF;EAAA,IAOEC,sBAPF,GAUIR,KAVJ,CAOEQ,sBAPF;EAAA,IAQEC,uBARF,GAUIT,KAVJ,CAQES,uBARF;EAAA,IASKC,UATL,4BAUIV,KAVJ;;EAWA,eAAqBZ,OAAO,CAACgB,cAAD,CAA5B;EAAA;EAAA,IAAOO,UAAP;;EACA,gBAA6BvB,OAAO,CAACoB,sBAAD,CAApC;EAAA;EAAA,IAAOI,kBAAP;;EACA,gBAA8BxB,OAAO,CAACqB,uBAAD,CAArC;EAAA;EAAA,IAAOI,mBAAP;;EAEA,IAAIC,IAAI,GAAG,CAAX;EAEA,IAAMC,KAAwB,GAAG,EAAjC;;EAEA,KAAK,IAAIC,WAAW,GAAG,CAAvB,EAA0BA,WAAW,GAAGL,UAAU,CAACd,MAAnD,EAA2DmB,WAAW,EAAtE,EAA0E;IAAA;;IACxE,4BAMIL,UAAU,CAACK,WAAD,CANd;IAAA,IACEC,WADF,yBACEA,WADF;IAAA,IAEEC,QAFF,yBAEEA,QAFF;IAAA,IAGEpB,MAHF,yBAGEA,MAHF;IAAA,IAIcqB,UAJd,yBAIEC,UAJF;IAAA,IAKWC,UALX,yBAKE1B,OALF;;IAQA,IAAImB,IAAJ,EAAU;MACRA,IAAI,GAAGA,IAAI,GAAGA,IAAI,GAAG,CAAV,GAAcA,IAAzB;MAEA;IACD;;IAEDA,IAAI,GAAGpB,OAAO,CACZ2B,UADY,aACZA,UADY,uBACZA,UAAU,CAAG;MAAEf,GAAG,EAAHA;IAAF,CAAH,CADE,EAEZU,WAFY,EAGZL,UAAU,CAACd,MAHC,EAIZ,CAAC,CAACC,MAJU,CAAd;;IAOA,IACG,CAACA,MAAD,IACCkB,WAAW,KAAK,CADjB,IAECJ,kBAAkB,IAAI,CAFvB,IAGCA,kBAAkB,GAAGI,WAArB,GAAmCF,IAAnC,IAA2C,CAH7C,IAIC,CAAChB,MAAD,IACCkB,WAAW,KAAK,CADjB,IAECH,mBAAmB,IAAI,CAFxB,IAGCA,mBAAmB,GAAGG,WAAtB,IAAqCL,UAAU,CAACd,MARpD,EASE;MACA;IACD;;IAEDkB,KAAK,CAACO,IAAN,CACE,oBAAC,YAAD;MACE,GAAG,EAAE7B,UAAU,CAAC,MAAD,EAAS;QAAE8B,GAAG,EAAEL,QAAQ,IAAIF;MAAnB,CAAT,CADjB;MAEE,UAAU,EACRA,WAAW,KAAK,CAAhB,IACA,EAAElB,MAAM,KAAK,MAAX,IAAqB,gBAAAa,UAAU,CAACK,WAAW,GAAG,CAAf,CAAV,4DAA6BlB,MAA7B,MAAwC,MAA/D,CAJJ;MAME,WAAW,EACTA,MAAM,KAAK,MAAX,IAAqB,iBAAAa,UAAU,CAACK,WAAW,GAAG,CAAf,CAAV,8DAA6BlB,MAA7B,MAAwC,MAPjE;MASE,SAAS,EAAE,CAACmB,WAAD,IAAgBd,QAAQ,KAAK,CAT1C;MAUE,GAAG,EAAEa,WAAW,KAAK,CAAhB,GAAoBf,GAApB,GAA0BuB,SAVjC;MAWE,GAAG,EAAElB,GAXP;MAYE,QAAQ,EAAEH,QAZZ;MAaE,IAAI,EAAEW,IAbR;MAcE,KAAK,EAAEE,WAdT;MAeE,QAAQ,EAAET,QAfZ;MAgBE,QAAQ,EAAEW,QAhBZ;MAiBE,SAAS,EAAED,WAjBb;MAkBE,MAAM,EAAEnB,MAlBV;MAmBE,UAAU,EAAEqB;IAnBd,EADF;EAuBD;;EAED,OACE,6CACMT,UADN;IAEE,SAAS,EAAEjB,UAAU,CAAC;MAAEY,YAAY,EAAZA;IAAF,CAAD,EAAmB,CAACH,SAAD,CAAnB,CAFvB;IAGE,eAAY;EAHd,IAKGa,KALH,CADF;AASD,CAzFoD,CAA9C"}