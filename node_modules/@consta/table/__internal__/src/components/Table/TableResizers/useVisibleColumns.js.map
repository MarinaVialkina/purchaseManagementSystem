{"version":3,"file":"useVisibleColumns.js","names":["useAction","useAtom","useLayoutEffect","useVisibleColumns","refs","intersectingColumnsAtom","rootAtom","root","setIntersectingColumns","ctx","index","value","state","get","newState","observers","ref","observer","IntersectionObserver","entries","isIntersecting","current","observe","length","forEach","disconnect"],"sources":["../../../../../../src/components/Table/TableResizers/useVisibleColumns.ts"],"sourcesContent":["import { AtomMut } from '@reatom/core';\nimport { useAction, useAtom } from '@reatom/npm-react';\nimport { useLayoutEffect } from 'react';\n\nexport const useVisibleColumns = (\n  refs: React.RefObject<HTMLDivElement>[],\n  intersectingColumnsAtom: AtomMut<boolean[]>,\n  rootAtom: AtomMut<HTMLDivElement | null>,\n) => {\n  const [root] = useAtom(rootAtom);\n  const setIntersectingColumns = useAction(\n    (ctx, index: number, value: boolean) => {\n      const state = ctx.get(intersectingColumnsAtom);\n      const newState = [...state];\n      newState[index] = value;\n\n      intersectingColumnsAtom(ctx, newState);\n    },\n  );\n\n  useLayoutEffect(() => {\n    const observers: IntersectionObserver[] = [];\n\n    if (root) {\n      for (let index = 0; index < refs.length; index++) {\n        const ref = refs[index];\n        const observer = new IntersectionObserver(\n          (entries) => setIntersectingColumns(index, entries[0].isIntersecting),\n          { root },\n        );\n\n        ref.current && observer.observe(ref.current);\n      }\n    }\n\n    return () => {\n      observers.forEach((observer) => observer.disconnect());\n    };\n  }, [refs, root]);\n};\n"],"mappings":";;AACA,SAASA,SAAT,EAAoBC,OAApB,QAAmC,mBAAnC;AACA,SAASC,eAAT,QAAgC,OAAhC;AAEA,OAAO,IAAMC,iBAAiB,GAAG,SAApBA,iBAAoB,CAC/BC,IAD+B,EAE/BC,uBAF+B,EAG/BC,QAH+B,EAI5B;EACH,eAAeL,OAAO,CAACK,QAAD,CAAtB;EAAA;EAAA,IAAOC,IAAP;;EACA,IAAMC,sBAAsB,GAAGR,SAAS,CACtC,UAACS,GAAD,EAAMC,KAAN,EAAqBC,KAArB,EAAwC;IACtC,IAAMC,KAAK,GAAGH,GAAG,CAACI,GAAJ,CAAQR,uBAAR,CAAd;;IACA,IAAMS,QAAQ,sBAAOF,KAAP,CAAd;;IACAE,QAAQ,CAACJ,KAAD,CAAR,GAAkBC,KAAlB;IAEAN,uBAAuB,CAACI,GAAD,EAAMK,QAAN,CAAvB;EACD,CAPqC,CAAxC;EAUAZ,eAAe,CAAC,YAAM;IACpB,IAAMa,SAAiC,GAAG,EAA1C;;IAEA,IAAIR,IAAJ,EAAU;MAAA,2BACCG,KADD;QAEN,IAAMM,GAAG,GAAGZ,IAAI,CAACM,KAAD,CAAhB;QACA,IAAMO,QAAQ,GAAG,IAAIC,oBAAJ,CACf,UAACC,OAAD;UAAA,OAAaX,sBAAsB,CAACE,KAAD,EAAQS,OAAO,CAAC,CAAD,CAAP,CAAWC,cAAnB,CAAnC;QAAA,CADe,EAEf;UAAEb,IAAI,EAAJA;QAAF,CAFe,CAAjB;QAKAS,GAAG,CAACK,OAAJ,IAAeJ,QAAQ,CAACK,OAAT,CAAiBN,GAAG,CAACK,OAArB,CAAf;MARM;;MACR,KAAK,IAAIX,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAGN,IAAI,CAACmB,MAAjC,EAAyCb,KAAK,EAA9C,EAAkD;QAAA,MAAzCA,KAAyC;MAQjD;IACF;;IAED,OAAO,YAAM;MACXK,SAAS,CAACS,OAAV,CAAkB,UAACP,QAAD;QAAA,OAAcA,QAAQ,CAACQ,UAAT,EAAd;MAAA,CAAlB;IACD,CAFD;EAGD,CAlBc,EAkBZ,CAACrB,IAAD,EAAOG,IAAP,CAlBY,CAAf;AAmBD,CAnCM"}