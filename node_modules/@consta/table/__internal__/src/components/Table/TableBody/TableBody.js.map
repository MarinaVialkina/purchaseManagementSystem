{"version":3,"file":"TableBody.js","names":["useCreateAtom","usePropAtom","useSendToAtom","cnMixScrollBar","useForkRef","getElementSize","useAction","useAtom","React","forwardRef","memo","useMemo","useRef","useResizeObservedAtom","cn","columnDefaultMinWidth","separatorLargeWidth","separatorWidth","cnTableCell","TableResizers","TableSeparatorTitles","TableVirtualScrollSpaceTop","getGridTemplate","getStyleByArray","getStyleLeftOffsetsForStickyColumns","getStyleRightOffsetsForStickyColumns","printSize","useResizableColumns","cnTableBody","getRandomHash","Array","from","crypto","getRandomValues","Uint8Array","map","b","toString","padStart","join","Style","atom","className","Styles","atoms","index","TableBodyRoot","ref","children","headerHeightAtom","spaceTopAtom","sizesAtom","topOffsetsAtom","stickyTopOffsetsAtom","headerZIndexAtom","resizingAtom","otherProps","instance","split","randomClass","bodyRef","bodySizeAtom","bodyOffsetHeightSizeAtom","el","scrollHeight","tableBodyHorizontalScrollHeightAtom","clientHeight","offsetHeight","tableBodyHorizontalScrollHeightStyleAtom","ctx","spy","tableBodyHeightAtom","height","bodyOffsetHeightAtom","tableBodyWidthAtom","width","tableHeaderHeightAtom","tableBodySpaceTopAtom","sizesLength","length","tableGrigColumnsLengthAtom","tableGridTemplateColumnsAtom","tableColumnSizesAtom","tableColumnLeftOffsetsAtom","tableColumnRightOffsetsAtom","tableResizerTopOffsetsAtom","tableResizerStickyTopOffsetsAtom","tableRowGridColumn","tableOverScrollDisplayAtom","tableHeaderZIndexAtom","TableBody","props","lowHeadersAtom","resizersRefsAtom","header","body","resizable","stickyHeader","headerZIndex","intersectingColumnsAtom","propsAtom","resizableAtom","bodyElAtom","setBodyEl","lowHeaders","resizersRefs","isSeparator","minWidth","maxWidth","title","currentSeparatorWidth","blocks","container","handlersAtom","activeIndexAtom","sticky"],"sources":["../../../../../../src/components/Table/TableBody/TableBody.tsx"],"sourcesContent":["import './TableBody.css';\n\nimport { useCreateAtom } from '@consta/uikit/__internal__/src/utils/state/useCreateAtom';\nimport { usePropAtom } from '@consta/uikit/__internal__/src/utils/state/usePickAtom';\nimport { useSendToAtom } from '@consta/uikit/__internal__/src/utils/state/useSendToAtom';\nimport { cnMixScrollBar } from '@consta/uikit/MixScrollBar';\nimport { useForkRef } from '@consta/uikit/useForkRef';\nimport { getElementSize } from '@consta/uikit/useResizeObserved';\nimport { AtomMut } from '@reatom/core';\nimport { useAction, useAtom } from '@reatom/npm-react';\nimport React, { forwardRef, memo, useMemo, useRef } from 'react';\n\nimport { useResizeObservedAtom } from '##/hooks/useResizeObservedAtom';\nimport { cn } from '##/utils/bem';\n\nimport {\n  columnDefaultMinWidth,\n  separatorLargeWidth,\n  separatorWidth,\n} from '../helpers';\nimport { cnTableCell } from '../TableCell';\nimport { TableResizers } from '../TableResizers';\nimport { TableSeparatorTitles } from '../TableSeparatorTitles';\nimport { TableVirtualScrollSpaceTop } from '../TableVirtualScrollSpaceTop';\nimport { TableBodyComponent, TableBodyRootComponent } from '../types';\nimport {\n  getGridTemplate,\n  getStyleByArray,\n  getStyleLeftOffsetsForStickyColumns,\n  getStyleRightOffsetsForStickyColumns,\n  printSize,\n} from './helpers';\nimport { useResizableColumns } from './useResizableColumns';\n\nexport const cnTableBody = cn('TableBody');\n\nconst getRandomHash = () =>\n  Array.from(crypto.getRandomValues(new Uint8Array(16)))\n    .map((b) => b.toString(16).padStart(2, '0'))\n    .join('');\n\nconst Style = ({\n  atom,\n  className,\n}: {\n  atom: AtomMut<string>;\n  className: string;\n}) => {\n  return (\n    <style>\n      {`.${className} {`} {useAtom(atom)[0]} {`}`}\n    </style>\n  );\n};\n\nconst Styles = memo(\n  ({ atoms, className }: { atoms: AtomMut<string>[]; className: string }) => (\n    <>\n      {atoms.map((atom, index) => (\n        <Style key={index} atom={atom} className={className} />\n      ))}\n    </>\n  ),\n  () => true,\n);\n\nconst TableBodyRoot: TableBodyRootComponent = forwardRef(\n  (\n    {\n      children,\n      className,\n      headerHeightAtom,\n      spaceTopAtom,\n      sizesAtom,\n      topOffsetsAtom,\n      stickyTopOffsetsAtom,\n      headerZIndexAtom,\n      resizingAtom,\n      ...otherProps\n    },\n    ref,\n  ) => {\n    const [randomClass] = useAtom(\n      cnTableBody({ instance: getRandomHash() }).split(' ')[1],\n    );\n    const bodyRef = useRef<HTMLDivElement>(null);\n    const bodySizeAtom = useResizeObservedAtom(\n      useMemo(() => [bodyRef], [bodyRef]),\n      getElementSize,\n    );\n    const bodyOffsetHeightSizeAtom = useResizeObservedAtom(\n      useMemo(() => [bodyRef], [bodyRef]),\n      (el) => el?.scrollHeight || 0,\n    );\n\n    const tableBodyHorizontalScrollHeightAtom = useResizeObservedAtom(\n      useMemo(() => [bodyRef], [bodyRef]),\n      (el) => {\n        const clientHeight = el?.clientHeight || 0;\n        const offsetHeight = el?.offsetHeight || 0;\n\n        return offsetHeight - clientHeight;\n      },\n    );\n\n    const tableBodyHorizontalScrollHeightStyleAtom = useCreateAtom(\n      (ctx) =>\n        `--table-body-horizontal-scroll-height: ${\n          ctx.spy(tableBodyHorizontalScrollHeightAtom)[0]\n        }px;`,\n    );\n\n    const tableBodyHeightAtom = useCreateAtom(\n      (ctx) => `--table-body-height: ${ctx.spy(bodySizeAtom)[0].height}px;`,\n    );\n\n    const bodyOffsetHeightAtom = useCreateAtom(\n      (ctx) =>\n        `--table-body-offset-height: ${ctx.spy(bodyOffsetHeightSizeAtom)}px;`,\n    );\n\n    const tableBodyWidthAtom = useCreateAtom(\n      (ctx) => `--table-body-width: ${ctx.spy(bodySizeAtom)[0].width}px;`,\n    );\n    const tableHeaderHeightAtom = useCreateAtom(\n      (ctx) => `--table-header-height: ${ctx.spy(headerHeightAtom)}px;`,\n    );\n    const tableBodySpaceTopAtom = useCreateAtom(\n      (ctx) => `--table-body-space-top: ${ctx.spy(spaceTopAtom)}px;`,\n    );\n    const sizesLength = useCreateAtom((ctx) => ctx.spy(sizesAtom).length);\n    const tableGrigColumnsLengthAtom = useCreateAtom(\n      (ctx) => `--table-grid-columns-length: ${ctx.spy(sizesLength)};`,\n    );\n    const tableGridTemplateColumnsAtom = useCreateAtom(\n      (ctx) =>\n        `--table-grid-template-columns: ${getGridTemplate(\n          ctx.spy(sizesLength),\n        )};`,\n    );\n    const tableColumnSizesAtom = useCreateAtom((ctx) =>\n      getStyleByArray(ctx.spy(sizesAtom), '--table-column-size', printSize),\n    );\n    const tableColumnLeftOffsetsAtom = useCreateAtom((ctx) =>\n      getStyleLeftOffsetsForStickyColumns(ctx.spy(sizesLength)),\n    );\n    const tableColumnRightOffsetsAtom = useCreateAtom((ctx) =>\n      getStyleRightOffsetsForStickyColumns(ctx.spy(sizesLength)),\n    );\n    const tableResizerTopOffsetsAtom = useCreateAtom((ctx) =>\n      getStyleByArray(ctx.spy(topOffsetsAtom), '--table-resizer-top-offset'),\n    );\n    const tableResizerStickyTopOffsetsAtom = useCreateAtom((ctx) =>\n      getStyleByArray(\n        ctx.spy(stickyTopOffsetsAtom),\n        '--table-column-sticky-top-offset',\n      ),\n    );\n    const tableRowGridColumn = useCreateAtom(\n      (ctx) => `--table-row-grid-column: span ${ctx.spy(sizesLength)}`,\n    );\n    const tableOverScrollDisplayAtom = useCreateAtom((ctx) =>\n      ctx.spy(resizingAtom) ? '--table-over-scroll-display: block' : '',\n    );\n    const tableHeaderZIndexAtom = useCreateAtom(\n      (ctx) => `--table-header-z-index: ${ctx.spy(headerZIndexAtom)};`,\n    );\n\n    return (\n      <div\n        {...otherProps}\n        className={cnTableBody(null, [\n          cnMixScrollBar(),\n          randomClass,\n          className,\n        ])}\n        ref={useForkRef([ref, bodyRef])}\n      >\n        <Styles\n          className={randomClass}\n          atoms={[\n            tableBodyHorizontalScrollHeightStyleAtom,\n            bodyOffsetHeightAtom,\n            tableBodyHeightAtom,\n            tableBodyWidthAtom,\n            tableHeaderHeightAtom,\n            tableBodySpaceTopAtom,\n            tableGrigColumnsLengthAtom,\n            tableGridTemplateColumnsAtom,\n            tableRowGridColumn,\n            tableOverScrollDisplayAtom,\n            tableHeaderZIndexAtom,\n            tableColumnSizesAtom,\n            tableColumnLeftOffsetsAtom,\n            tableColumnRightOffsetsAtom,\n            tableResizerTopOffsetsAtom,\n            tableResizerStickyTopOffsetsAtom,\n          ]}\n        />\n        {children}\n      </div>\n    );\n  },\n);\n\nexport const TableBody: TableBodyComponent = forwardRef((props, ref) => {\n  const {\n    children,\n    spaceTopAtom,\n    topOffsetsAtom,\n    headerHeightAtom,\n    lowHeadersAtom,\n    resizersRefsAtom,\n    header,\n    body,\n    resizable,\n    stickyTopOffsetsAtom,\n    stickyHeader,\n    headerZIndex,\n    intersectingColumnsAtom,\n\n    ...otherProps\n  } = props;\n\n  const propsAtom = useSendToAtom(props);\n  const headerZIndexAtom = usePropAtom(propsAtom, 'headerZIndex');\n  const resizableAtom = usePropAtom(propsAtom, 'resizable');\n\n  const bodyRef = useRef<HTMLDivElement>(null);\n  const bodyElAtom = useCreateAtom<HTMLDivElement | null>(null);\n  const setBodyEl = useAction((ctx, el: HTMLDivElement) => bodyElAtom(ctx, el));\n\n  const [blocks] = useAtom((ctx) => {\n    const lowHeaders = ctx.spy(lowHeadersAtom);\n    const resizersRefs = ctx.spy(resizersRefsAtom);\n    return lowHeaders.map(\n      ({ isSeparator, width, minWidth, maxWidth, title }, index) => {\n        const currentSeparatorWidth = title\n          ? separatorLargeWidth\n          : separatorWidth;\n\n        return isSeparator\n          ? {\n              ref: resizersRefs[index],\n              maxWidth: currentSeparatorWidth,\n              minWidth: currentSeparatorWidth,\n              width: currentSeparatorWidth,\n            }\n          : {\n              ref: resizersRefs[index],\n              minWidth: minWidth || columnDefaultMinWidth,\n              maxWidth,\n              width,\n            };\n      },\n    );\n  });\n\n  const { handlersAtom, sizesAtom, activeIndexAtom, resizingAtom } =\n    useResizableColumns({\n      resizable,\n      container: bodyRef,\n      blocks,\n    });\n\n  return (\n    <TableBodyRoot\n      {...otherProps}\n      ref={useForkRef([ref, bodyRef, setBodyEl])}\n      headerHeightAtom={headerHeightAtom}\n      spaceTopAtom={spaceTopAtom}\n      sizesAtom={sizesAtom}\n      topOffsetsAtom={topOffsetsAtom}\n      stickyTopOffsetsAtom={stickyTopOffsetsAtom}\n      headerZIndexAtom={headerZIndexAtom}\n      resizingAtom={resizingAtom}\n    >\n      <div className={cnTableBody('OverScroll')} />\n      {header}\n      <div\n        className={cnTableBody('Separator', { sticky: stickyHeader }, [\n          cnTableCell(),\n        ])}\n      />\n      <TableSeparatorTitles lowHeadersAtom={lowHeadersAtom} />\n      <TableResizers\n        bodyElAtom={bodyElAtom}\n        lowHeadersAtom={lowHeadersAtom}\n        resizersRefsAtom={resizersRefsAtom}\n        handlersAtom={handlersAtom}\n        resizableAtom={resizableAtom}\n        activeIndexAtom={activeIndexAtom}\n        intersectingColumnsAtom={intersectingColumnsAtom}\n      />\n      <TableVirtualScrollSpaceTop />\n      {body}\n    </TableBodyRoot>\n  );\n});\n"],"mappings":";;;;AAAA;AAEA,SAASA,aAAT,QAA8B,0DAA9B;AACA,SAASC,WAAT,QAA4B,wDAA5B;AACA,SAASC,aAAT,QAA8B,0DAA9B;AACA,SAASC,cAAT,QAA+B,4BAA/B;AACA,SAASC,UAAT,QAA2B,0BAA3B;AACA,SAASC,cAAT,QAA+B,iCAA/B;AAEA,SAASC,SAAT,EAAoBC,OAApB,QAAmC,mBAAnC;AACA,OAAOC,KAAP,IAAgBC,UAAhB,EAA4BC,IAA5B,EAAkCC,OAAlC,EAA2CC,MAA3C,QAAyD,OAAzD;AAEA,SAASC,qBAAT;AACA,SAASC,EAAT;AAEA,SACEC,qBADF,EAEEC,mBAFF,EAGEC,cAHF;AAKA,SAASC,WAAT;AACA,SAASC,aAAT;AACA,SAASC,oBAAT;AACA,SAASC,0BAAT;AAEA,SACEC,eADF,EAEEC,eAFF,EAGEC,mCAHF,EAIEC,oCAJF,EAKEC,SALF;AAOA,SAASC,mBAAT;AAEA,OAAO,IAAMC,WAAW,GAAGd,EAAE,CAAC,WAAD,CAAtB;;AAEP,IAAMe,aAAa,GAAG,SAAhBA,aAAgB;EAAA,OACpBC,KAAK,CAACC,IAAN,CAAWC,MAAM,CAACC,eAAP,CAAuB,IAAIC,UAAJ,CAAe,EAAf,CAAvB,CAAX,EACGC,GADH,CACO,UAACC,CAAD;IAAA,OAAOA,CAAC,CAACC,QAAF,CAAW,EAAX,EAAeC,QAAf,CAAwB,CAAxB,EAA2B,GAA3B,CAAP;EAAA,CADP,EAEGC,IAFH,CAEQ,EAFR,CADoB;AAAA,CAAtB;;AAKA,IAAMC,KAAK,GAAG,SAARA,KAAQ,OAMR;EAAA,IALJC,IAKI,QALJA,IAKI;EAAA,IAJJC,SAII,QAJJA,SAII;EACJ,OACE,8CACOA,SADP,cACuBnC,OAAO,CAACkC,IAAD,CAAP,CAAc,CAAd,CADvB,WADF;AAKD,CAZD;;AAcA,IAAME,MAAM,GAAGjC,IAAI,CACjB;EAAA,IAAGkC,KAAH,SAAGA,KAAH;EAAA,IAAUF,SAAV,SAAUA,SAAV;EAAA,OACE,0CACGE,KAAK,CAACT,GAAN,CAAU,UAACM,IAAD,EAAOI,KAAP;IAAA,OACT,oBAAC,KAAD;MAAO,GAAG,EAAEA,KAAZ;MAAmB,IAAI,EAAEJ,IAAzB;MAA+B,SAAS,EAAEC;IAA1C,EADS;EAAA,CAAV,CADH,CADF;AAAA,CADiB,EAQjB;EAAA,OAAM,IAAN;AAAA,CARiB,CAAnB;AAWA,IAAMI,aAAqC,GAAGrC,UAAU,CACtD,iBAaEsC,GAbF,EAcK;EAAA,IAZDC,QAYC,SAZDA,QAYC;EAAA,IAXDN,SAWC,SAXDA,SAWC;EAAA,IAVDO,gBAUC,SAVDA,gBAUC;EAAA,IATDC,YASC,SATDA,YASC;EAAA,IARDC,SAQC,SARDA,SAQC;EAAA,IAPDC,cAOC,SAPDA,cAOC;EAAA,IANDC,oBAMC,SANDA,oBAMC;EAAA,IALDC,gBAKC,SALDA,gBAKC;EAAA,IAJDC,YAIC,SAJDA,YAIC;EAAA,IAHEC,UAGF;;EACH,eAAsBjD,OAAO,CAC3BqB,WAAW,CAAC;IAAE6B,QAAQ,EAAE5B,aAAa;EAAzB,CAAD,CAAX,CAA2C6B,KAA3C,CAAiD,GAAjD,EAAsD,CAAtD,CAD2B,CAA7B;EAAA;EAAA,IAAOC,WAAP;;EAGA,IAAMC,OAAO,GAAGhD,MAAM,CAAiB,IAAjB,CAAtB;EACA,IAAMiD,YAAY,GAAGhD,qBAAqB,CACxCF,OAAO,CAAC;IAAA,OAAM,CAACiD,OAAD,CAAN;EAAA,CAAD,EAAkB,CAACA,OAAD,CAAlB,CADiC,EAExCvD,cAFwC,CAA1C;EAIA,IAAMyD,wBAAwB,GAAGjD,qBAAqB,CACpDF,OAAO,CAAC;IAAA,OAAM,CAACiD,OAAD,CAAN;EAAA,CAAD,EAAkB,CAACA,OAAD,CAAlB,CAD6C,EAEpD,UAACG,EAAD;IAAA,OAAQ,CAAAA,EAAE,SAAF,IAAAA,EAAE,WAAF,YAAAA,EAAE,CAAEC,YAAJ,KAAoB,CAA5B;EAAA,CAFoD,CAAtD;EAKA,IAAMC,mCAAmC,GAAGpD,qBAAqB,CAC/DF,OAAO,CAAC;IAAA,OAAM,CAACiD,OAAD,CAAN;EAAA,CAAD,EAAkB,CAACA,OAAD,CAAlB,CADwD,EAE/D,UAACG,EAAD,EAAQ;IACN,IAAMG,YAAY,GAAG,CAAAH,EAAE,SAAF,IAAAA,EAAE,WAAF,YAAAA,EAAE,CAAEG,YAAJ,KAAoB,CAAzC;IACA,IAAMC,YAAY,GAAG,CAAAJ,EAAE,SAAF,IAAAA,EAAE,WAAF,YAAAA,EAAE,CAAEI,YAAJ,KAAoB,CAAzC;IAEA,OAAOA,YAAY,GAAGD,YAAtB;EACD,CAP8D,CAAjE;EAUA,IAAME,wCAAwC,GAAGpE,aAAa,CAC5D,UAACqE,GAAD;IAAA,wDAEIA,GAAG,CAACC,GAAJ,CAAQL,mCAAR,EAA6C,CAA7C,CAFJ;EAAA,CAD4D,CAA9D;EAOA,IAAMM,mBAAmB,GAAGvE,aAAa,CACvC,UAACqE,GAAD;IAAA,sCAAiCA,GAAG,CAACC,GAAJ,CAAQT,YAAR,EAAsB,CAAtB,EAAyBW,MAA1D;EAAA,CADuC,CAAzC;EAIA,IAAMC,oBAAoB,GAAGzE,aAAa,CACxC,UAACqE,GAAD;IAAA,6CACiCA,GAAG,CAACC,GAAJ,CAAQR,wBAAR,CADjC;EAAA,CADwC,CAA1C;EAKA,IAAMY,kBAAkB,GAAG1E,aAAa,CACtC,UAACqE,GAAD;IAAA,qCAAgCA,GAAG,CAACC,GAAJ,CAAQT,YAAR,EAAsB,CAAtB,EAAyBc,KAAzD;EAAA,CADsC,CAAxC;EAGA,IAAMC,qBAAqB,GAAG5E,aAAa,CACzC,UAACqE,GAAD;IAAA,wCAAmCA,GAAG,CAACC,GAAJ,CAAQrB,gBAAR,CAAnC;EAAA,CADyC,CAA3C;EAGA,IAAM4B,qBAAqB,GAAG7E,aAAa,CACzC,UAACqE,GAAD;IAAA,yCAAoCA,GAAG,CAACC,GAAJ,CAAQpB,YAAR,CAApC;EAAA,CADyC,CAA3C;EAGA,IAAM4B,WAAW,GAAG9E,aAAa,CAAC,UAACqE,GAAD;IAAA,OAASA,GAAG,CAACC,GAAJ,CAAQnB,SAAR,EAAmB4B,MAA5B;EAAA,CAAD,CAAjC;EACA,IAAMC,0BAA0B,GAAGhF,aAAa,CAC9C,UAACqE,GAAD;IAAA,8CAAyCA,GAAG,CAACC,GAAJ,CAAQQ,WAAR,CAAzC;EAAA,CAD8C,CAAhD;EAGA,IAAMG,4BAA4B,GAAGjF,aAAa,CAChD,UAACqE,GAAD;IAAA,gDACoC/C,eAAe,CAC/C+C,GAAG,CAACC,GAAJ,CAAQQ,WAAR,CAD+C,CADnD;EAAA,CADgD,CAAlD;EAMA,IAAMI,oBAAoB,GAAGlF,aAAa,CAAC,UAACqE,GAAD;IAAA,OACzC9C,eAAe,CAAC8C,GAAG,CAACC,GAAJ,CAAQnB,SAAR,CAAD,EAAqB,qBAArB,EAA4CzB,SAA5C,CAD0B;EAAA,CAAD,CAA1C;EAGA,IAAMyD,0BAA0B,GAAGnF,aAAa,CAAC,UAACqE,GAAD;IAAA,OAC/C7C,mCAAmC,CAAC6C,GAAG,CAACC,GAAJ,CAAQQ,WAAR,CAAD,CADY;EAAA,CAAD,CAAhD;EAGA,IAAMM,2BAA2B,GAAGpF,aAAa,CAAC,UAACqE,GAAD;IAAA,OAChD5C,oCAAoC,CAAC4C,GAAG,CAACC,GAAJ,CAAQQ,WAAR,CAAD,CADY;EAAA,CAAD,CAAjD;EAGA,IAAMO,0BAA0B,GAAGrF,aAAa,CAAC,UAACqE,GAAD;IAAA,OAC/C9C,eAAe,CAAC8C,GAAG,CAACC,GAAJ,CAAQlB,cAAR,CAAD,EAA0B,4BAA1B,CADgC;EAAA,CAAD,CAAhD;EAGA,IAAMkC,gCAAgC,GAAGtF,aAAa,CAAC,UAACqE,GAAD;IAAA,OACrD9C,eAAe,CACb8C,GAAG,CAACC,GAAJ,CAAQjB,oBAAR,CADa,EAEb,kCAFa,CADsC;EAAA,CAAD,CAAtD;EAMA,IAAMkC,kBAAkB,GAAGvF,aAAa,CACtC,UAACqE,GAAD;IAAA,+CAA0CA,GAAG,CAACC,GAAJ,CAAQQ,WAAR,CAA1C;EAAA,CADsC,CAAxC;EAGA,IAAMU,0BAA0B,GAAGxF,aAAa,CAAC,UAACqE,GAAD;IAAA,OAC/CA,GAAG,CAACC,GAAJ,CAAQf,YAAR,IAAwB,oCAAxB,GAA+D,EADhB;EAAA,CAAD,CAAhD;EAGA,IAAMkC,qBAAqB,GAAGzF,aAAa,CACzC,UAACqE,GAAD;IAAA,yCAAoCA,GAAG,CAACC,GAAJ,CAAQhB,gBAAR,CAApC;EAAA,CADyC,CAA3C;EAIA,OACE,6CACME,UADN;IAEE,SAAS,EAAE5B,WAAW,CAAC,IAAD,EAAO,CAC3BzB,cAAc,EADa,EAE3BwD,WAF2B,EAG3BjB,SAH2B,CAAP,CAFxB;IAOE,GAAG,EAAEtC,UAAU,CAAC,CAAC2C,GAAD,EAAMa,OAAN,CAAD;EAPjB,IASE,oBAAC,MAAD;IACE,SAAS,EAAED,WADb;IAEE,KAAK,EAAE,CACLS,wCADK,EAELK,oBAFK,EAGLF,mBAHK,EAILG,kBAJK,EAKLE,qBALK,EAMLC,qBANK,EAOLG,0BAPK,EAQLC,4BARK,EASLM,kBATK,EAULC,0BAVK,EAWLC,qBAXK,EAYLP,oBAZK,EAaLC,0BAbK,EAcLC,2BAdK,EAeLC,0BAfK,EAgBLC,gCAhBK;EAFT,EATF,EA8BGtC,QA9BH,CADF;AAkCD,CAxIqD,CAAxD;AA2IA,OAAO,IAAM0C,SAA6B,GAAGjF,UAAU,CAAC,UAACkF,KAAD,EAAQ5C,GAAR,EAAgB;EACtE,IACEC,QADF,GAgBI2C,KAhBJ,CACE3C,QADF;EAAA,IAEEE,YAFF,GAgBIyC,KAhBJ,CAEEzC,YAFF;EAAA,IAGEE,cAHF,GAgBIuC,KAhBJ,CAGEvC,cAHF;EAAA,IAIEH,gBAJF,GAgBI0C,KAhBJ,CAIE1C,gBAJF;EAAA,IAKE2C,cALF,GAgBID,KAhBJ,CAKEC,cALF;EAAA,IAMEC,gBANF,GAgBIF,KAhBJ,CAMEE,gBANF;EAAA,IAOEC,MAPF,GAgBIH,KAhBJ,CAOEG,MAPF;EAAA,IAQEC,IARF,GAgBIJ,KAhBJ,CAQEI,IARF;EAAA,IASEC,SATF,GAgBIL,KAhBJ,CASEK,SATF;EAAA,IAUE3C,oBAVF,GAgBIsC,KAhBJ,CAUEtC,oBAVF;EAAA,IAWE4C,YAXF,GAgBIN,KAhBJ,CAWEM,YAXF;EAAA,IAYEC,YAZF,GAgBIP,KAhBJ,CAYEO,YAZF;EAAA,IAaEC,uBAbF,GAgBIR,KAhBJ,CAaEQ,uBAbF;EAAA,IAeK3C,UAfL,4BAgBImC,KAhBJ;;EAkBA,IAAMS,SAAS,GAAGlG,aAAa,CAACyF,KAAD,CAA/B;EACA,IAAMrC,gBAAgB,GAAGrD,WAAW,CAACmG,SAAD,EAAY,cAAZ,CAApC;EACA,IAAMC,aAAa,GAAGpG,WAAW,CAACmG,SAAD,EAAY,WAAZ,CAAjC;EAEA,IAAMxC,OAAO,GAAGhD,MAAM,CAAiB,IAAjB,CAAtB;EACA,IAAM0F,UAAU,GAAGtG,aAAa,CAAwB,IAAxB,CAAhC;EACA,IAAMuG,SAAS,GAAGjG,SAAS,CAAC,UAAC+D,GAAD,EAAMN,EAAN;IAAA,OAA6BuC,UAAU,CAACjC,GAAD,EAAMN,EAAN,CAAvC;EAAA,CAAD,CAA3B;;EAEA,gBAAiBxD,OAAO,CAAC,UAAC8D,GAAD,EAAS;IAChC,IAAMmC,UAAU,GAAGnC,GAAG,CAACC,GAAJ,CAAQsB,cAAR,CAAnB;IACA,IAAMa,YAAY,GAAGpC,GAAG,CAACC,GAAJ,CAAQuB,gBAAR,CAArB;IACA,OAAOW,UAAU,CAACrE,GAAX,CACL,iBAAoDU,KAApD,EAA8D;MAAA,IAA3D6D,WAA2D,SAA3DA,WAA2D;MAAA,IAA9C/B,KAA8C,SAA9CA,KAA8C;MAAA,IAAvCgC,QAAuC,SAAvCA,QAAuC;MAAA,IAA7BC,QAA6B,SAA7BA,QAA6B;MAAA,IAAnBC,KAAmB,SAAnBA,KAAmB;MAC5D,IAAMC,qBAAqB,GAAGD,KAAK,GAC/B7F,mBAD+B,GAE/BC,cAFJ;MAIA,OAAOyF,WAAW,GACd;QACE3D,GAAG,EAAE0D,YAAY,CAAC5D,KAAD,CADnB;QAEE+D,QAAQ,EAAEE,qBAFZ;QAGEH,QAAQ,EAAEG,qBAHZ;QAIEnC,KAAK,EAAEmC;MAJT,CADc,GAOd;QACE/D,GAAG,EAAE0D,YAAY,CAAC5D,KAAD,CADnB;QAEE8D,QAAQ,EAAEA,QAAQ,IAAI5F,qBAFxB;QAGE6F,QAAQ,EAARA,QAHF;QAIEjC,KAAK,EAALA;MAJF,CAPJ;IAaD,CAnBI,CAAP;EAqBD,CAxBuB,CAAxB;EAAA;EAAA,IAAOoC,MAAP;;EA0BA,2BACEpF,mBAAmB,CAAC;IAClBqE,SAAS,EAATA,SADkB;IAElBgB,SAAS,EAAEpD,OAFO;IAGlBmD,MAAM,EAANA;EAHkB,CAAD,CADrB;EAAA,IAAQE,YAAR,wBAAQA,YAAR;EAAA,IAAsB9D,SAAtB,wBAAsBA,SAAtB;EAAA,IAAiC+D,eAAjC,wBAAiCA,eAAjC;EAAA,IAAkD3D,YAAlD,wBAAkDA,YAAlD;;EAOA,OACE,oBAAC,aAAD,oBACMC,UADN;IAEE,GAAG,EAAEpD,UAAU,CAAC,CAAC2C,GAAD,EAAMa,OAAN,EAAe2C,SAAf,CAAD,CAFjB;IAGE,gBAAgB,EAAEtD,gBAHpB;IAIE,YAAY,EAAEC,YAJhB;IAKE,SAAS,EAAEC,SALb;IAME,cAAc,EAAEC,cANlB;IAOE,oBAAoB,EAAEC,oBAPxB;IAQE,gBAAgB,EAAEC,gBARpB;IASE,YAAY,EAAEC;EAThB,IAWE;IAAK,SAAS,EAAE3B,WAAW,CAAC,YAAD;EAA3B,EAXF,EAYGkE,MAZH,EAaE;IACE,SAAS,EAAElE,WAAW,CAAC,WAAD,EAAc;MAAEuF,MAAM,EAAElB;IAAV,CAAd,EAAwC,CAC5D/E,WAAW,EADiD,CAAxC;EADxB,EAbF,EAkBE,oBAAC,oBAAD;IAAsB,cAAc,EAAE0E;EAAtC,EAlBF,EAmBE,oBAAC,aAAD;IACE,UAAU,EAAEU,UADd;IAEE,cAAc,EAAEV,cAFlB;IAGE,gBAAgB,EAAEC,gBAHpB;IAIE,YAAY,EAAEoB,YAJhB;IAKE,aAAa,EAAEZ,aALjB;IAME,eAAe,EAAEa,eANnB;IAOE,uBAAuB,EAAEf;EAP3B,EAnBF,EA4BE,oBAAC,0BAAD,OA5BF,EA6BGJ,IA7BH,CADF;AAiCD,CA7FsD,CAAhD"}