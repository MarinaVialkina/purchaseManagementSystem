{"version":3,"file":"useResizeObservedAtom.js","names":["useCreateAtom","useAction","useLayoutEffect","useResizeObservedAtom","refs","mapper","dimensionsAtom","map","ref","current","setDimensionsAction","ctx","dimensions","resizeObserver","ResizeObserver","observe","disconnect"],"sources":["../../../../../src/hooks/useResizeObservedAtom/useResizeObservedAtom.ts"],"sourcesContent":["import { useCreateAtom } from '@consta/uikit/__internal__/src/utils/state/useCreateAtom';\nimport { AtomMut } from '@reatom/core';\nimport { useAction } from '@reatom/npm-react';\nimport { RefObject, useLayoutEffect } from 'react';\n\nexport const useResizeObservedAtom = <\n  ELEMENT extends HTMLElement | SVGGraphicsElement,\n  RETURN_TYPE,\n>(\n  refs: Array<RefObject<ELEMENT>>,\n  mapper: (el: ELEMENT | null) => RETURN_TYPE,\n): AtomMut<RETURN_TYPE[]> => {\n  const dimensionsAtom = useCreateAtom(refs.map((ref) => mapper(ref.current)));\n\n  const setDimensionsAction = useAction((ctx, dimensions: RETURN_TYPE[]) => {\n    dimensionsAtom(ctx, dimensions);\n  });\n\n  useLayoutEffect(() => {\n    setDimensionsAction(refs.map((ref) => mapper(ref.current)));\n  }, [refs]);\n\n  useLayoutEffect(() => {\n    const resizeObserver = new ResizeObserver(() => {\n      setDimensionsAction(refs.map((ref) => mapper(ref.current)));\n    });\n\n    for (const ref of refs) {\n      ref.current && resizeObserver.observe(ref.current);\n    }\n\n    return () => {\n      resizeObserver.disconnect();\n    };\n  }, [refs]);\n\n  return dimensionsAtom;\n};\n"],"mappings":";;;;;;AAAA,SAASA,aAAT,QAA8B,0DAA9B;AAEA,SAASC,SAAT,QAA0B,mBAA1B;AACA,SAAoBC,eAApB,QAA2C,OAA3C;AAEA,OAAO,IAAMC,qBAAqB,GAAG,SAAxBA,qBAAwB,CAInCC,IAJmC,EAKnCC,MALmC,EAMR;EAC3B,IAAMC,cAAc,GAAGN,aAAa,CAACI,IAAI,CAACG,GAAL,CAAS,UAACC,GAAD;IAAA,OAASH,MAAM,CAACG,GAAG,CAACC,OAAL,CAAf;EAAA,CAAT,CAAD,CAApC;EAEA,IAAMC,mBAAmB,GAAGT,SAAS,CAAC,UAACU,GAAD,EAAMC,UAAN,EAAoC;IACxEN,cAAc,CAACK,GAAD,EAAMC,UAAN,CAAd;EACD,CAFoC,CAArC;EAIAV,eAAe,CAAC,YAAM;IACpBQ,mBAAmB,CAACN,IAAI,CAACG,GAAL,CAAS,UAACC,GAAD;MAAA,OAASH,MAAM,CAACG,GAAG,CAACC,OAAL,CAAf;IAAA,CAAT,CAAD,CAAnB;EACD,CAFc,EAEZ,CAACL,IAAD,CAFY,CAAf;EAIAF,eAAe,CAAC,YAAM;IACpB,IAAMW,cAAc,GAAG,IAAIC,cAAJ,CAAmB,YAAM;MAC9CJ,mBAAmB,CAACN,IAAI,CAACG,GAAL,CAAS,UAACC,GAAD;QAAA,OAASH,MAAM,CAACG,GAAG,CAACC,OAAL,CAAf;MAAA,CAAT,CAAD,CAAnB;IACD,CAFsB,CAAvB;;IADoB,2CAKFL,IALE;IAAA;;IAAA;MAKpB,oDAAwB;QAAA,IAAbI,GAAa;QACtBA,GAAG,CAACC,OAAJ,IAAeI,cAAc,CAACE,OAAf,CAAuBP,GAAG,CAACC,OAA3B,CAAf;MACD;IAPmB;MAAA;IAAA;MAAA;IAAA;;IASpB,OAAO,YAAM;MACXI,cAAc,CAACG,UAAf;IACD,CAFD;EAGD,CAZc,EAYZ,CAACZ,IAAD,CAZY,CAAf;EAcA,OAAOE,cAAP;AACD,CAhCM"}