import _objectWithoutProperties from "@babel/runtime/helpers/objectWithoutProperties";
const _excluded = ["size", "className"],
      _excluded2 = ["children"];
import React, { isValidElement, useContext, useEffect, useMemo } from 'react';
import { cnIcons, IconsContext } from "../../components/IconsProvider";
import { renderTypeDefault } from "./helpers";
export const createSvg = createProps => props => {
  const {
    name,
    renderType = renderTypeDefault
  } = createProps;

  const {
    size = 'm',
    className
  } = props,
        otherProps = _objectWithoutProperties(props, _excluded);

  const Svg = createProps[size];
  const {
    addIcon,
    removeIcon
  } = useContext(IconsContext);
  const SvgElement = useMemo(() => {
    return renderType[size] === 'use' ? Svg({
      className
    }) : null;
  }, [Svg]);

  const _ref = isValidElement(SvgElement) ? (SvgElement === null || SvgElement === void 0 ? void 0 : SvgElement.props) || {} : {},
        {
    children: _children
  } = _ref,
        svgProps = _objectWithoutProperties(_ref, _excluded2);

  useEffect(() => {
    if (renderType[size] === 'use') {
      addIcon === null || addIcon === void 0 ? void 0 : addIcon(name, size, SvgElement);
    }
  }, [SvgElement, renderType, size]);
  useEffect(() => {
    return () => {
      if (renderType[size] === 'use') {
        removeIcon === null || removeIcon === void 0 ? void 0 : removeIcon(name, size);
      }
    };
  }, [Svg, renderType, size]);

  if (addIcon && renderType[size] === 'use') {
    return React.createElement("svg", Object.assign({}, otherProps, svgProps), React.createElement("use", {
      x: "0",
      y: "0",
      xlinkHref: `#${cnIcons(`${name}_${size}`)}`
    }));
  }

  return React.createElement(Svg, {
    className: className
  });
};
//# sourceMappingURL=createSvg.js.map